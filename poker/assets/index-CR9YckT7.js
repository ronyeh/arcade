(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const f of document.querySelectorAll('link[rel="modulepreload"]'))c(f);new MutationObserver(f=>{for(const l of f)if(l.type==="childList")for(const p of l.addedNodes)p.tagName==="LINK"&&p.rel==="modulepreload"&&c(p)}).observe(document,{childList:!0,subtree:!0});function o(f){const l={};return f.integrity&&(l.integrity=f.integrity),f.referrerPolicy&&(l.referrerPolicy=f.referrerPolicy),f.crossOrigin==="use-credentials"?l.credentials="include":f.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function c(f){if(f.ep)return;f.ep=!0;const l=o(f);fetch(f.href,l)}})();var Ce=(_=>(_.Hearts="H",_.Diamonds="D",_.Clubs="C",_.Spades="S",_))(Ce||{}),Z=(_=>(_.Two="2",_.Three="3",_.Four="4",_.Five="5",_.Six="6",_.Seven="7",_.Eight="8",_.Nine="9",_.Ten="T",_.Jack="J",_.Queen="Q",_.King="K",_.Ace="A",_))(Z||{});function Ne(_,n){return{rank:_,suit:n,toString(){return`${this.rank}${this.suit}`}}}class er{constructor(){this.cards=[],this.initializeDeck()}initializeDeck(){this.cards=[];for(const n of Object.values(Ce))for(const o of Object.values(Z))this.cards.push(Ne(o,n))}shuffle(){for(let n=this.cards.length-1;n>0;n--){const o=Math.floor(Math.random()*(n+1));[this.cards[n],this.cards[o]]=[this.cards[o],this.cards[n]]}}deal(){if(this.cards.length!==0)return this.cards.pop()}getCardsCount(){return this.cards.length}reset(){this.initializeDeck(),this.shuffle()}}class We{constructor(n,o,c){this.id=n,this.name=o,this.chips=c,this.hand=[],this.currentBet=0,this.folded=!1,this.isAllIn=!1}receiveCard(n){this.hand.push(n)}clearHand(){this.hand=[],this.currentBet=0,this.folded=!1,this.isAllIn=!1}fold(){this.folded=!0,console.log(`${this.name} folds.`)}placeBet(n){const o=Math.min(n,this.chips);return this.chips-=o,this.currentBet+=o,this.chips===0&&(this.isAllIn=!0,console.log(`${this.name} is All-In!`)),o}bet(n){return console.log(`${this.name} bets ${n}.`),this.placeBet(n)}call(n){const o=n-this.currentBet;return o<=0?(console.log(`${this.name} checks.`),0):(console.log(`${this.name} calls ${o}.`),this.placeBet(o))}raise(n,o){const c=o+n-this.currentBet;return console.log(`${this.name} raises by ${n} (total bet this round will be ${this.currentBet+c}).`),this.placeBet(c)}winPot(n){this.chips+=n,console.log(`${this.name} wins ${n} chips.`)}returnBet(n){this.chips+=n,this.currentBet-=n}toJSON(){return{id:this.id,name:this.name,chips:this.chips,currentBet:this.currentBet,folded:this.folded,isAllIn:this.isAllIn,hand:this.hand.map(n=>({rank:n.rank,suit:n.suit}))}}static fromJSON(n){const o=new We(n.id,n.name,n.chips);return o.currentBet=n.currentBet,o.folded=n.folded,o.isAllIn=n.isAllIn,o.hand=n.hand.map(c=>Ne(c.rank,c.suit)),o}updateFromJSON(n){this.chips=n.chips,this.currentBet=n.currentBet,this.folded=n.folded,this.isAllIn=n.isAllIn,this.hand=n.hand.map(o=>Ne(o.rank,o.suit))}}const pt={HIGH_CARD:0},Oe={[Z.Two]:2,[Z.Three]:3,[Z.Four]:4,[Z.Five]:5,[Z.Six]:6,[Z.Seven]:7,[Z.Eight]:8,[Z.Nine]:9,[Z.Ten]:10,[Z.Jack]:11,[Z.Queen]:12,[Z.King]:13,[Z.Ace]:14};class tr{constructor(){}evaluateHand(n){if(!n||n.length===0)return{rank:pt.HIGH_CARD,value:[0],handName:"No cards"};const o=[...n].sort((f,l)=>Oe[l.rank]-Oe[f.rank]);Oe[o[0].rank];const c=o.map(f=>Oe[f.rank]);return{rank:pt.HIGH_CARD,value:c,handName:`High Card: ${o[0].rank}`}}}var ge=(_=>(_[_.Preflop=0]="Preflop",_[_.Flop=1]="Flop",_[_.Turn=2]="Turn",_[_.River=3]="River",_[_.Showdown=4]="Showdown",_[_.GameOver=5]="GameOver",_))(ge||{});class Pe{constructor(n,o,c=5,f=10){this.players=n.map((l,p)=>new We(`p${p}`,l,o)),this.deck=new er,this.handEvaluator=new tr,this.smallBlind=c,this.bigBlind=f,this.minRaiseAmount=f,this.dealerIndex=-1,this.communityCards=[],this.pot=0,this.currentPlayerIndex=0,this.currentRoundBet=0,this.bettingRound=0,this.activePlayers=[]}setupNewHand(){if(this.deck.reset(),this.communityCards=[],this.pot=0,this.currentRoundBet=0,this.minRaiseAmount=this.bigBlind,this.lastPlayerToRaiseId=void 0,this.players.forEach(p=>p.clearHand()),this.activePlayers=this.players.filter(p=>p.chips>0),this.activePlayers.length<2){this.bettingRound=5,console.log("Game Over: Not enough players with chips.");return}this.dealerIndex=(this.dealerIndex+1)%this.players.length;let n=(this.dealerIndex+1)%this.players.length;for(;!this.activePlayers.find(p=>p.id===this.players[n].id)||this.players[n].chips===0;)n=(n+1)%this.players.length;let o=(n+1)%this.players.length;for(;!this.activePlayers.find(p=>p.id===this.players[o].id)||this.players[o].chips===0;)o=(o+1)%this.players.length;const c=this.players[n],f=this.players[o];console.log(`Dealer is ${this.players[this.dealerIndex].name}`),this.pot+=c.bet(this.smallBlind),console.log(`${c.name} posts small blind ${this.smallBlind}. CurrentBet: ${c.currentBet}`),this.pot+=f.bet(this.bigBlind),console.log(`${f.name} posts big blind ${this.bigBlind}. CurrentBet: ${f.currentBet}`),this.currentRoundBet=this.bigBlind,this.lastPlayerToRaiseId=f.id;let l=(o+1)%this.players.length;for(;(!this.activePlayers.find(p=>p.id===this.players[l].id)||this.players[l].chips===0)&&(l=(l+1)%this.players.length,l!==o););this.currentPlayerIndex=this.activePlayers.findIndex(p=>p.id===this.players[l].id),this.bettingRound=0,console.log(`New hand. Dealer: ${this.players[this.dealerIndex].name}. SB: ${c.name}, BB: ${f.name}.`),this.currentPlayerIndex!==-1?console.log(`Action starts with: ${this.activePlayers[this.currentPlayerIndex].name}.`):console.log("Error determining first player to act.")}dealHands(){if(this.bettingRound===0){console.log("Dealing hands...");for(let n=0;n<2;n++)for(const o of this.activePlayers)if(!o.folded&&o.chips>0){const c=this.deck.deal();c&&o.receiveCard(c)}this.activePlayers.forEach(n=>{n.folded||console.log(`${n.name} has: ${n.hand.map(o=>o.toString()).join(", ")}`)})}}dealFlop(){if(this.bettingRound===1){console.log("Dealing flop..."),this.deck.deal();for(let n=0;n<3;n++){const o=this.deck.deal();o&&this.communityCards.push(o)}console.log(`Flop: ${this.communityCards.map(n=>n.toString()).join(", ")}`)}}dealTurn(){if(this.bettingRound!==2)return;console.log("Dealing turn..."),this.deck.deal();const n=this.deck.deal();n&&this.communityCards.push(n),console.log(`Turn: ${this.communityCards[this.communityCards.length-1].toString()} (Board: ${this.communityCards.map(o=>o.toString()).join(", ")})`)}dealRiver(){if(this.bettingRound!==3)return;console.log("Dealing river..."),this.deck.deal();const n=this.deck.deal();n&&this.communityCards.push(n),console.log(`River: ${this.communityCards[this.communityCards.length-1].toString()} (Board: ${this.communityCards.map(o=>o.toString()).join(", ")})`)}collectBetsAndStartNextRound(){console.log("Collecting bets for the round."),this.currentRoundBet=0,this.minRaiseAmount=this.bigBlind,this.lastPlayerToRaiseId=void 0,this.activePlayers.filter(o=>!o.folded).forEach(o=>o.currentBet=0);let n=(this.dealerIndex+1)%this.players.length;for(;(!this.activePlayers.find(o=>o.id===this.players[n].id)||this.players[n].folded||this.players[n].isAllIn)&&(n=(n+1)%this.players.length,n!==(this.dealerIndex+1)%this.players.length););switch(this.currentPlayerIndex=this.activePlayers.findIndex(o=>o.id===this.players[n].id),this.bettingRound){case 0:this.bettingRound=1,this.dealFlop();break;case 1:this.bettingRound=2,this.dealTurn();break;case 2:this.bettingRound=3,this.dealRiver();break;case 3:this.bettingRound=4,this.determineWinner();break;default:console.log("Cannot start next betting round from current state:",this.bettingRound);return}this.bettingRound!==4&&this.bettingRound!==5&&(this.currentPlayerIndex!==-1&&this.activePlayers[this.currentPlayerIndex]?console.log(`Starting ${ge[this.bettingRound]} betting round. ${this.activePlayers[this.currentPlayerIndex].name} to act.`):this.activePlayers.filter(o=>!o.folded&&!o.isAllIn).length>0?(this.currentPlayerIndex=this.activePlayers.findIndex(o=>!o.folded&&!o.isAllIn),this.currentPlayerIndex!==-1?console.log(`Starting ${ge[this.bettingRound]} betting round. ${this.activePlayers[this.currentPlayerIndex].name} to act (first was all-in/folded).`):(console.log(`${ge[this.bettingRound]} betting round, but all players are all-in or folded. Proceeding.`),this.collectBetsAndStartNextRound())):(console.log(`${ge[this.bettingRound]} betting round, but no player can act. Proceeding to showdown/end.`),this.bettingRound=4,this.determineWinner()))}handlePlayerAction(n,o,c){var p,i;const f=this.activePlayers.find(b=>b.id===n);if(!f||f.id!==((p=this.activePlayers[this.currentPlayerIndex])==null?void 0:p.id))return console.error(`Action by wrong player (${n}) or player not found. Current is ${(i=this.activePlayers[this.currentPlayerIndex])==null?void 0:i.id}`),!1;if(f.folded||f.isAllIn)return console.log(`Player ${f.name} cannot act (folded/all-in). Advancing.`),this.advanceToNextPlayerOrRound(),!1;let l=0;switch(o){case"fold":f.fold(),console.log(`${f.name} folds.`);break;case"check":if(f.currentBet<this.currentRoundBet)return console.log(`${f.name} cannot check, current bet is ${this.currentRoundBet}. Must call ${this.currentRoundBet-f.currentBet} or raise.`),!1;console.log(`${f.name} checks.`);break;case"call":f.currentBet>=this.currentRoundBet?console.log(`${f.name} tries to call but has already matched the bet or bet more. Interpreting as check.`):(l=f.call(this.currentRoundBet),this.pot+=l,console.log(`${f.name} calls ${l}. Player total bet this round: ${f.currentBet}`));break;case"bet":if(this.currentRoundBet>0)return console.log(`${f.name} cannot bet, currentRoundBet is ${this.currentRoundBet}. Must call or raise.`),!1;if(!c||c<=0)return console.log("Bet amount invalid."),!1;if(c<this.minRaiseAmount&&f.chips>c)return console.log(`${f.name} bet amount ${c} is less than min bet ${this.minRaiseAmount}.`),!1;l=f.bet(c),this.pot+=l,this.currentRoundBet=f.currentBet,this.minRaiseAmount=c,this.lastPlayerToRaiseId=f.id,console.log(`${f.name} bets ${l}. CurrentRoundBet: ${this.currentRoundBet}. MinRaise: ${this.minRaiseAmount}`);break;case"raise":if(this.currentRoundBet===0)return console.log("Cannot raise, no bet yet. Use 'bet'."),!1;if(!c||c<=0)return console.log("Raise amount invalid."),!1;const b=this.currentRoundBet+c;if(c<this.minRaiseAmount&&f.chips>b)return console.log(`${f.name} raise amount ${c} is less than min raise amount ${this.minRaiseAmount}.`),!1;l=f.raise(c,this.currentRoundBet),this.pot+=l,this.currentRoundBet=f.currentBet,this.minRaiseAmount=c,this.lastPlayerToRaiseId=f.id,console.log(`${f.name} raises by ${c} to ${this.currentRoundBet}. MinRaise for next: ${this.minRaiseAmount}`);break;default:return console.error("Unknown action:",o),!1}return this.advanceToNextPlayerOrRound(),!0}advanceToNextPlayerOrRound(){const n=this.activePlayers.filter(l=>!l.folded);if(n.length===1){this.awardPotToWinner(n[0]),this.setupNewHand();return}let o=(this.currentPlayerIndex+1)%this.activePlayers.length;for(;(this.activePlayers[o].folded||this.activePlayers[o].isAllIn)&&(o=(o+1)%this.activePlayers.length,o!==this.currentPlayerIndex););const c=this.activePlayers.find(l=>l.id===this.lastPlayerToRaiseId);c&&this.activePlayers.indexOf(c);const f=n.every(l=>l.id===this.lastPlayerToRaiseId||l.currentBet===this.currentRoundBet||l.isAllIn||l.folded);if(this.lastPlayerToRaiseId&&this.activePlayers[o].id===this.lastPlayerToRaiseId&&f){console.log("Betting round ended. Action back to last raiser who has already acted or all matched."),this.collectBetsAndStartNextRound();return}if(this.currentRoundBet===0&&this.lastPlayerToRaiseId===void 0&&n.filter(p=>!p.isAllIn&&p.currentBet<this.currentRoundBet).length===0&&n.every(p=>p.currentBet===this.currentRoundBet||p.isAllIn||p.folded)){console.log("Betting round ended. All players matched, are all-in, or folded."),this.collectBetsAndStartNextRound();return}this.currentPlayerIndex=o,this.currentPlayerIndex!==-1&&this.activePlayers[this.currentPlayerIndex]?console.log(`Next to act: ${this.activePlayers[this.currentPlayerIndex].name}`):(console.error("Could not determine next player. Ending round."),this.collectBetsAndStartNextRound())}awardPotToWinner(n){console.log(`${n.name} wins the pot of ${this.pot}!`),n.winPot(this.pot),this.pot=0}determineWinner(){if(this.bettingRound!==4)return;console.log("Determining winner...");const n=this.activePlayers.filter(c=>!c.folded);if(n.length===0){this.bettingRound=5,this.setupNewHand();return}if(n.length===1){this.awardPotToWinner(n[0]),this.setupNewHand();return}let o=[];if(n.forEach(c=>{const f=[...c.hand,...this.communityCards],l=this.handEvaluator.evaluateHand(f);if(console.log(`${c.name} has ${c.hand.map(p=>p.toString())} (Board: ${this.communityCards.map(p=>p.toString())}) - ${l.handName} (Value: ${l.value})`),o.length===0||l.rank>o[0].eval.rank)o=[{player:c,eval:l}];else if(l.rank===o[0].eval.rank){let p=!1;for(let i=0;i<l.value.length;i++){if(l.value[i]>o[0].eval.value[i]){o=[{player:c,eval:l}],p=!1;break}if(l.value[i]<o[0].eval.value[i]){p=!1;break}i===l.value.length-1&&(p=!0)}p&&o.push({player:c,eval:l})}}),o.length>0)if(o.length===1)this.awardPotToWinner(o[0].player);else{const c=o.map(l=>l.player.name).join(", ");console.log(`Split pot between: ${c} with ${o[0].eval.handName}`);const f=Math.floor(this.pot/o.length);o.forEach(l=>l.player.winPot(f)),this.pot=0}else console.log("Error: Could not determine a winner.");console.log("Showdown finished."),this.setupNewHand()}toJSON(){var n;return{players:this.players.map(o=>o.toJSON()),communityCards:this.communityCards.map(o=>({rank:o.rank,suit:o.suit})),pot:this.pot,currentActivePlayerId:(n=this.activePlayers[this.currentPlayerIndex])==null?void 0:n.id,currentRoundBet:this.currentRoundBet,bettingRound:this.bettingRound,dealerIndex:this.dealerIndex,minRaiseAmount:this.minRaiseAmount,bigBlind:this.bigBlind,smallBlind:this.smallBlind,lastPlayerToRaiseId:this.lastPlayerToRaiseId}}static fromJSON(n,o){const c=new Pe([],0,n.smallBlind,n.bigBlind);c.players=n.players.map(l=>{const p=l.id===o?"You":`Peer (${l.id})`,i=We.fromJSON(l);return i.name=p,i}),c.communityCards=n.communityCards.map(l=>Ne(l.rank,l.suit)),c.pot=n.pot,c.dealerIndex=n.dealerIndex,c.activePlayers=c.players.filter(l=>l.chips>0&&!l.folded);const f=c.activePlayers.find(l=>l.id===n.currentActivePlayerId);return f?c.currentPlayerIndex=c.activePlayers.indexOf(f):c.activePlayers.length>0?c.currentPlayerIndex=0:c.currentPlayerIndex=-1,c.currentRoundBet=n.currentRoundBet,c.bettingRound=n.bettingRound,c.minRaiseAmount=n.minRaiseAmount||n.bigBlind,c.lastPlayerToRaiseId=n.lastPlayerToRaiseId,console.log("GameState hydrated from JSON:",c),c}updateFromJSON(n,o){n.players.forEach(f=>{const l=this.players.find(p=>p.id===f.id);l?(l.updateFromJSON(f),l.name=f.id===o?"You":`Peer (${f.id})`):console.warn(`Player with id ${f.id} from JSON not found locally.`)}),this.communityCards=n.communityCards.map(f=>Ne(f.rank,f.suit)),this.pot=n.pot,this.activePlayers=this.players.filter(f=>f.chips>0&&!f.folded);const c=this.activePlayers.find(f=>f.id===n.currentActivePlayerId);c?this.currentPlayerIndex=this.activePlayers.indexOf(c):this.activePlayers.length>0?this.currentPlayerIndex=0:this.currentPlayerIndex=-1,this.currentRoundBet=n.currentRoundBet,this.bettingRound=n.bettingRound,this.minRaiseAmount=n.minRaiseAmount||n.bigBlind,this.lastPlayerToRaiseId=n.lastPlayerToRaiseId,console.log("GameState updated by peer data.")}}const ne="http://www.w3.org/2000/svg",fe=60,pe=90,rr=5,nr="black",ir="white",or={[Ce.Hearts]:"red",[Ce.Diamonds]:"red",[Ce.Clubs]:"black",[Ce.Spades]:"black"};class sr{constructor(n="game-container"){const o=document.getElementById(n);if(!o)throw new Error(`Container with id "${n}" not found.`);this.gameContainer=o,this.svg=document.createElementNS(ne,"svg"),this.svg.setAttribute("width",this.gameContainer.style.width||"800"),this.svg.setAttribute("height",this.gameContainer.style.height||"600"),this.svg.setAttribute("viewBox",`0 0 ${this.gameContainer.style.width||800} ${this.gameContainer.style.height||600}`),this.gameContainer.appendChild(this.svg),this.defineGlobalStyles()}defineGlobalStyles(){const n=document.createElementNS(ne,"defs"),o=document.createElementNS(ne,"style");o.textContent=`
            .card-rect {
                stroke: ${nr};
                stroke-width: 1;
                fill: ${ir};
                rx: ${rr};
            }
            .card-text {
                font-family: sans-serif;
                font-size: 18px;
                text-anchor: middle;
                dominant-baseline: middle;
            }
            .player-info-text {
                font-family: sans-serif;
                font-size: 14px;
                fill: white; /* Changed to white for better visibility on dark green */
                text-anchor: middle; /* Centering player name/chips */
            }
            .bet-text { /* Specific style for bet amounts */
                font-family: sans-serif;
                font-size: 12px;
                fill: yellow;
                text-anchor: middle;
            }
            .pot-text {
                font-family: sans-serif;
                font-size: 18px;
                fill: yellow;
                text-anchor: middle;
            }
            .folded-text {
                font-family: sans-serif;
                font-size: 16px;
                fill: orange;
                text-anchor: middle;
                dominant-baseline: middle;
            }
        `,n.appendChild(o),this.svg.appendChild(n)}clearContent(){const n=Array.from(this.svg.children);for(const o of n)o.tagName.toLowerCase()!=="defs"&&this.svg.removeChild(o)}drawCard(n,o,c,f,l=!1){const p=document.createElementNS(ne,"g");f&&p.setAttribute("id",f),p.setAttribute("transform",`translate(${o}, ${c})`),p.classList.add("card-svg-group");const i=document.createElementNS(ne,"rect");i.setAttribute("width",fe.toString()),i.setAttribute("height",pe.toString()),i.classList.add("card-rect"),l&&i.setAttribute("fill","darkslateblue"),p.appendChild(i);const b=l?"??":n.toString(),S=l?"white":or[n.suit],B=document.createElementNS(ne,"text");return B.setAttribute("x",(fe/2).toString()),B.setAttribute("y",(pe/2).toString()),B.classList.add("card-text"),B.style.fill=S,B.textContent=b,p.appendChild(B),this.svg.appendChild(p),p}drawTable(n,o,c){this.clearContent();const f=parseFloat(this.svg.getAttribute("width")||"800"),l=parseFloat(this.svg.getAttribute("height")||"600"),p=o.length,i=p*fe+Math.max(0,p-1)*10,b=(f-i)/2,S=l/2-pe/2-30;o.forEach((y,d)=>{this.drawCard(y,b+d*(fe+10),S,`community-card-${d}`)});const B=n.length,E=f*.4,C=l*.3,T=f/2,s=l/2+30;n.forEach((y,d)=>{const w=d/B*2*Math.PI-Math.PI/2,I=T+E*Math.cos(w),F=s+C*Math.sin(w),P=document.createElementNS(ne,"text");if(P.setAttribute("x",I.toString()),P.setAttribute("y",(F-pe*.5-15).toString()),P.classList.add("player-info-text"),P.textContent=`${y.name}: ${y.chips}`,this.svg.appendChild(P),y.currentBet>0){const D=document.createElementNS(ne,"text");D.setAttribute("x",I.toString()),D.setAttribute("y",(F+pe*.5+20).toString()),D.classList.add("bet-text"),D.textContent=`Bet: ${y.currentBet}`,this.svg.appendChild(D)}const O=-fe*.8;if(y.hand.forEach((D,L)=>{const U=y.name.toLowerCase().includes("peer");this.drawCard(D,I+O+L*(fe+5),F-pe*.5,`player-${y.id}-card-${L}`,U&&!y.folded)}),y.folded){const D=document.createElementNS(ne,"text");D.setAttribute("x",(I-fe*.3).toString()),D.setAttribute("y",F.toString()),D.classList.add("folded-text"),D.textContent="FOLDED",this.svg.appendChild(D)}});const m=document.createElementNS(ne,"text");m.setAttribute("x",(f/2).toString()),m.setAttribute("y",(S+pe+30).toString()),m.classList.add("pot-text"),m.textContent=`Pot: ${c}`,this.svg.appendChild(m)}getSVGElement(){return this.svg}}var oe=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function ar(_){return _&&_.__esModule&&Object.prototype.hasOwnProperty.call(_,"default")?_.default:_}function lr(_){if(Object.prototype.hasOwnProperty.call(_,"__esModule"))return _;var n=_.default;if(typeof n=="function"){var o=function c(){return this instanceof c?Reflect.construct(n,arguments,this.constructor):n.apply(this,arguments)};o.prototype=n.prototype}else o={};return Object.defineProperty(o,"__esModule",{value:!0}),Object.keys(_).forEach(function(c){var f=Object.getOwnPropertyDescriptor(_,c);Object.defineProperty(o,c,f.get?f:{enumerable:!0,get:function(){return _[c]}})}),o}var De={exports:{}},je,gt;function ur(){if(gt)return je;gt=1;var _=1e3,n=_*60,o=n*60,c=o*24,f=c*7,l=c*365.25;je=function(B,E){E=E||{};var C=typeof B;if(C==="string"&&B.length>0)return p(B);if(C==="number"&&isFinite(B))return E.long?b(B):i(B);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(B))};function p(B){if(B=String(B),!(B.length>100)){var E=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(B);if(E){var C=parseFloat(E[1]),T=(E[2]||"ms").toLowerCase();switch(T){case"years":case"year":case"yrs":case"yr":case"y":return C*l;case"weeks":case"week":case"w":return C*f;case"days":case"day":case"d":return C*c;case"hours":case"hour":case"hrs":case"hr":case"h":return C*o;case"minutes":case"minute":case"mins":case"min":case"m":return C*n;case"seconds":case"second":case"secs":case"sec":case"s":return C*_;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return C;default:return}}}}function i(B){var E=Math.abs(B);return E>=c?Math.round(B/c)+"d":E>=o?Math.round(B/o)+"h":E>=n?Math.round(B/n)+"m":E>=_?Math.round(B/_)+"s":B+"ms"}function b(B){var E=Math.abs(B);return E>=c?S(B,E,c,"day"):E>=o?S(B,E,o,"hour"):E>=n?S(B,E,n,"minute"):E>=_?S(B,E,_,"second"):B+" ms"}function S(B,E,C,T){var s=E>=C*1.5;return Math.round(B/C)+" "+T+(s?"s":"")}return je}var Ge,yt;function cr(){if(yt)return Ge;yt=1;function _(n){c.debug=c,c.default=c,c.coerce=S,c.disable=i,c.enable=l,c.enabled=b,c.humanize=ur(),c.destroy=B,Object.keys(n).forEach(E=>{c[E]=n[E]}),c.names=[],c.skips=[],c.formatters={};function o(E){let C=0;for(let T=0;T<E.length;T++)C=(C<<5)-C+E.charCodeAt(T),C|=0;return c.colors[Math.abs(C)%c.colors.length]}c.selectColor=o;function c(E){let C,T=null,s,m;function y(...d){if(!y.enabled)return;const w=y,I=Number(new Date),F=I-(C||I);w.diff=F,w.prev=C,w.curr=I,C=I,d[0]=c.coerce(d[0]),typeof d[0]!="string"&&d.unshift("%O");let P=0;d[0]=d[0].replace(/%([a-zA-Z%])/g,(D,L)=>{if(D==="%%")return"%";P++;const U=c.formatters[L];if(typeof U=="function"){const J=d[P];D=U.call(w,J),d.splice(P,1),P--}return D}),c.formatArgs.call(w,d),(w.log||c.log).apply(w,d)}return y.namespace=E,y.useColors=c.useColors(),y.color=c.selectColor(E),y.extend=f,y.destroy=c.destroy,Object.defineProperty(y,"enabled",{enumerable:!0,configurable:!1,get:()=>T!==null?T:(s!==c.namespaces&&(s=c.namespaces,m=c.enabled(E)),m),set:d=>{T=d}}),typeof c.init=="function"&&c.init(y),y}function f(E,C){const T=c(this.namespace+(typeof C>"u"?":":C)+E);return T.log=this.log,T}function l(E){c.save(E),c.namespaces=E,c.names=[],c.skips=[];const C=(typeof E=="string"?E:"").trim().replace(/\s+/g,",").split(",").filter(Boolean);for(const T of C)T[0]==="-"?c.skips.push(T.slice(1)):c.names.push(T)}function p(E,C){let T=0,s=0,m=-1,y=0;for(;T<E.length;)if(s<C.length&&(C[s]===E[T]||C[s]==="*"))C[s]==="*"?(m=s,y=T,s++):(T++,s++);else if(m!==-1)s=m+1,y++,T=y;else return!1;for(;s<C.length&&C[s]==="*";)s++;return s===C.length}function i(){const E=[...c.names,...c.skips.map(C=>"-"+C)].join(",");return c.enable(""),E}function b(E){for(const C of c.skips)if(p(E,C))return!1;for(const C of c.names)if(p(E,C))return!0;return!1}function S(E){return E instanceof Error?E.stack||E.message:E}function B(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return c.enable(c.load()),c}return Ge=_,Ge}var mt;function hr(){return mt||(mt=1,function(_,n){var o={};n.formatArgs=f,n.save=l,n.load=p,n.useColors=c,n.storage=i(),n.destroy=(()=>{let S=!1;return()=>{S||(S=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),n.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function c(){if(typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs))return!0;if(typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;let S;return typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&(S=navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/))&&parseInt(S[1],10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function f(S){if(S[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+S[0]+(this.useColors?"%c ":" ")+"+"+_.exports.humanize(this.diff),!this.useColors)return;const B="color: "+this.color;S.splice(1,0,B,"color: inherit");let E=0,C=0;S[0].replace(/%[a-zA-Z%]/g,T=>{T!=="%%"&&(E++,T==="%c"&&(C=E))}),S.splice(C,0,B)}n.log=console.debug||console.log||(()=>{});function l(S){try{S?n.storage.setItem("debug",S):n.storage.removeItem("debug")}catch{}}function p(){let S;try{S=n.storage.getItem("debug")||n.storage.getItem("DEBUG")}catch{}return!S&&typeof process<"u"&&"env"in process&&(S=o.DEBUG),S}function i(){try{return localStorage}catch{}}_.exports=cr()(n);const{formatters:b}=_.exports;b.j=function(S){try{return JSON.stringify(S)}catch(B){return"[UnexpectedJSONParseError]: "+B.message}}}(De,De.exports)),De.exports}var Ye,wt;function dr(){return wt||(wt=1,Ye=function(){if(typeof globalThis>"u")return null;var n={RTCPeerConnection:globalThis.RTCPeerConnection||globalThis.mozRTCPeerConnection||globalThis.webkitRTCPeerConnection,RTCSessionDescription:globalThis.RTCSessionDescription||globalThis.mozRTCSessionDescription||globalThis.webkitRTCSessionDescription,RTCIceCandidate:globalThis.RTCIceCandidate||globalThis.mozRTCIceCandidate||globalThis.webkitRTCIceCandidate};return n.RTCPeerConnection?n:null}),Ye}var Me={exports:{}},Le={exports:{}},Ve={},xe={},_t;function fr(){if(_t)return xe;_t=1,xe.byteLength=i,xe.toByteArray=S,xe.fromByteArray=C;for(var _=[],n=[],o=typeof Uint8Array<"u"?Uint8Array:Array,c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",f=0,l=c.length;f<l;++f)_[f]=c[f],n[c.charCodeAt(f)]=f;n[45]=62,n[95]=63;function p(T){var s=T.length;if(s%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var m=T.indexOf("=");m===-1&&(m=s);var y=m===s?0:4-m%4;return[m,y]}function i(T){var s=p(T),m=s[0],y=s[1];return(m+y)*3/4-y}function b(T,s,m){return(s+m)*3/4-m}function S(T){var s,m=p(T),y=m[0],d=m[1],w=new o(b(T,y,d)),I=0,F=d>0?y-4:y,P;for(P=0;P<F;P+=4)s=n[T.charCodeAt(P)]<<18|n[T.charCodeAt(P+1)]<<12|n[T.charCodeAt(P+2)]<<6|n[T.charCodeAt(P+3)],w[I++]=s>>16&255,w[I++]=s>>8&255,w[I++]=s&255;return d===2&&(s=n[T.charCodeAt(P)]<<2|n[T.charCodeAt(P+1)]>>4,w[I++]=s&255),d===1&&(s=n[T.charCodeAt(P)]<<10|n[T.charCodeAt(P+1)]<<4|n[T.charCodeAt(P+2)]>>2,w[I++]=s>>8&255,w[I++]=s&255),w}function B(T){return _[T>>18&63]+_[T>>12&63]+_[T>>6&63]+_[T&63]}function E(T,s,m){for(var y,d=[],w=s;w<m;w+=3)y=(T[w]<<16&16711680)+(T[w+1]<<8&65280)+(T[w+2]&255),d.push(B(y));return d.join("")}function C(T){for(var s,m=T.length,y=m%3,d=[],w=16383,I=0,F=m-y;I<F;I+=w)d.push(E(T,I,I+w>F?F:I+w));return y===1?(s=T[m-1],d.push(_[s>>2]+_[s<<4&63]+"==")):y===2&&(s=(T[m-2]<<8)+T[m-1],d.push(_[s>>10]+_[s>>4&63]+_[s<<2&63]+"=")),d.join("")}return xe}var Ue={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */var bt;function pr(){return bt||(bt=1,Ue.read=function(_,n,o,c,f){var l,p,i=f*8-c-1,b=(1<<i)-1,S=b>>1,B=-7,E=o?f-1:0,C=o?-1:1,T=_[n+E];for(E+=C,l=T&(1<<-B)-1,T>>=-B,B+=i;B>0;l=l*256+_[n+E],E+=C,B-=8);for(p=l&(1<<-B)-1,l>>=-B,B+=c;B>0;p=p*256+_[n+E],E+=C,B-=8);if(l===0)l=1-S;else{if(l===b)return p?NaN:(T?-1:1)*(1/0);p=p+Math.pow(2,c),l=l-S}return(T?-1:1)*p*Math.pow(2,l-c)},Ue.write=function(_,n,o,c,f,l){var p,i,b,S=l*8-f-1,B=(1<<S)-1,E=B>>1,C=f===23?Math.pow(2,-24)-Math.pow(2,-77):0,T=c?0:l-1,s=c?1:-1,m=n<0||n===0&&1/n<0?1:0;for(n=Math.abs(n),isNaN(n)||n===1/0?(i=isNaN(n)?1:0,p=B):(p=Math.floor(Math.log(n)/Math.LN2),n*(b=Math.pow(2,-p))<1&&(p--,b*=2),p+E>=1?n+=C/b:n+=C*Math.pow(2,1-E),n*b>=2&&(p++,b/=2),p+E>=B?(i=0,p=B):p+E>=1?(i=(n*b-1)*Math.pow(2,f),p=p+E):(i=n*Math.pow(2,E-1)*Math.pow(2,f),p=0));f>=8;_[o+T]=i&255,T+=s,i/=256,f-=8);for(p=p<<f|i,S+=f;S>0;_[o+T]=p&255,T+=s,p/=256,S-=8);_[o+T-s]|=m*128}),Ue}/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */var Et;function Fe(){return Et||(Et=1,function(_){const n=fr(),o=pr(),c=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;_.Buffer=i,_.SlowBuffer=w,_.INSPECT_MAX_BYTES=50;const f=2147483647;_.kMaxLength=f,i.TYPED_ARRAY_SUPPORT=l(),!i.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function l(){try{const r=new Uint8Array(1),e={foo:function(){return 42}};return Object.setPrototypeOf(e,Uint8Array.prototype),Object.setPrototypeOf(r,e),r.foo()===42}catch{return!1}}Object.defineProperty(i.prototype,"parent",{enumerable:!0,get:function(){if(i.isBuffer(this))return this.buffer}}),Object.defineProperty(i.prototype,"offset",{enumerable:!0,get:function(){if(i.isBuffer(this))return this.byteOffset}});function p(r){if(r>f)throw new RangeError('The value "'+r+'" is invalid for option "size"');const e=new Uint8Array(r);return Object.setPrototypeOf(e,i.prototype),e}function i(r,e,t){if(typeof r=="number"){if(typeof e=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return E(r)}return b(r,e,t)}i.poolSize=8192;function b(r,e,t){if(typeof r=="string")return C(r,e);if(ArrayBuffer.isView(r))return s(r);if(r==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof r);if(ee(r,ArrayBuffer)||r&&ee(r.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(ee(r,SharedArrayBuffer)||r&&ee(r.buffer,SharedArrayBuffer)))return m(r,e,t);if(typeof r=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const a=r.valueOf&&r.valueOf();if(a!=null&&a!==r)return i.from(a,e,t);const g=y(r);if(g)return g;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof r[Symbol.toPrimitive]=="function")return i.from(r[Symbol.toPrimitive]("string"),e,t);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof r)}i.from=function(r,e,t){return b(r,e,t)},Object.setPrototypeOf(i.prototype,Uint8Array.prototype),Object.setPrototypeOf(i,Uint8Array);function S(r){if(typeof r!="number")throw new TypeError('"size" argument must be of type number');if(r<0)throw new RangeError('The value "'+r+'" is invalid for option "size"')}function B(r,e,t){return S(r),r<=0?p(r):e!==void 0?typeof t=="string"?p(r).fill(e,t):p(r).fill(e):p(r)}i.alloc=function(r,e,t){return B(r,e,t)};function E(r){return S(r),p(r<0?0:d(r)|0)}i.allocUnsafe=function(r){return E(r)},i.allocUnsafeSlow=function(r){return E(r)};function C(r,e){if((typeof e!="string"||e==="")&&(e="utf8"),!i.isEncoding(e))throw new TypeError("Unknown encoding: "+e);const t=I(r,e)|0;let a=p(t);const g=a.write(r,e);return g!==t&&(a=a.slice(0,g)),a}function T(r){const e=r.length<0?0:d(r.length)|0,t=p(e);for(let a=0;a<e;a+=1)t[a]=r[a]&255;return t}function s(r){if(ee(r,Uint8Array)){const e=new Uint8Array(r);return m(e.buffer,e.byteOffset,e.byteLength)}return T(r)}function m(r,e,t){if(e<0||r.byteLength<e)throw new RangeError('"offset" is outside of buffer bounds');if(r.byteLength<e+(t||0))throw new RangeError('"length" is outside of buffer bounds');let a;return e===void 0&&t===void 0?a=new Uint8Array(r):t===void 0?a=new Uint8Array(r,e):a=new Uint8Array(r,e,t),Object.setPrototypeOf(a,i.prototype),a}function y(r){if(i.isBuffer(r)){const e=d(r.length)|0,t=p(e);return t.length===0||r.copy(t,0,0,e),t}if(r.length!==void 0)return typeof r.length!="number"||he(r.length)?p(0):T(r);if(r.type==="Buffer"&&Array.isArray(r.data))return T(r.data)}function d(r){if(r>=f)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+f.toString(16)+" bytes");return r|0}function w(r){return+r!=r&&(r=0),i.alloc(+r)}i.isBuffer=function(e){return e!=null&&e._isBuffer===!0&&e!==i.prototype},i.compare=function(e,t){if(ee(e,Uint8Array)&&(e=i.from(e,e.offset,e.byteLength)),ee(t,Uint8Array)&&(t=i.from(t,t.offset,t.byteLength)),!i.isBuffer(e)||!i.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;let a=e.length,g=t.length;for(let v=0,x=Math.min(a,g);v<x;++v)if(e[v]!==t[v]){a=e[v],g=t[v];break}return a<g?-1:g<a?1:0},i.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},i.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(e.length===0)return i.alloc(0);let a;if(t===void 0)for(t=0,a=0;a<e.length;++a)t+=e[a].length;const g=i.allocUnsafe(t);let v=0;for(a=0;a<e.length;++a){let x=e[a];if(ee(x,Uint8Array))v+x.length>g.length?(i.isBuffer(x)||(x=i.from(x)),x.copy(g,v)):Uint8Array.prototype.set.call(g,x,v);else if(i.isBuffer(x))x.copy(g,v);else throw new TypeError('"list" argument must be an Array of Buffers');v+=x.length}return g};function I(r,e){if(i.isBuffer(r))return r.length;if(ArrayBuffer.isView(r)||ee(r,ArrayBuffer))return r.byteLength;if(typeof r!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof r);const t=r.length,a=arguments.length>2&&arguments[2]===!0;if(!a&&t===0)return 0;let g=!1;for(;;)switch(e){case"ascii":case"latin1":case"binary":return t;case"utf8":case"utf-8":return j(r).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return t*2;case"hex":return t>>>1;case"base64":return Te(r).length;default:if(g)return a?-1:j(r).length;e=(""+e).toLowerCase(),g=!0}}i.byteLength=I;function F(r,e,t){let a=!1;if((e===void 0||e<0)&&(e=0),e>this.length||((t===void 0||t>this.length)&&(t=this.length),t<=0)||(t>>>=0,e>>>=0,t<=e))return"";for(r||(r="utf8");;)switch(r){case"hex":return le(this,e,t);case"utf8":case"utf-8":return ye(this,e,t);case"ascii":return ie(this,e,t);case"latin1":case"binary":return me(this,e,t);case"base64":return ae(this,e,t);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return we(this,e,t);default:if(a)throw new TypeError("Unknown encoding: "+r);r=(r+"").toLowerCase(),a=!0}}i.prototype._isBuffer=!0;function P(r,e,t){const a=r[e];r[e]=r[t],r[t]=a}i.prototype.swap16=function(){const e=this.length;if(e%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let t=0;t<e;t+=2)P(this,t,t+1);return this},i.prototype.swap32=function(){const e=this.length;if(e%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let t=0;t<e;t+=4)P(this,t,t+3),P(this,t+1,t+2);return this},i.prototype.swap64=function(){const e=this.length;if(e%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let t=0;t<e;t+=8)P(this,t,t+7),P(this,t+1,t+6),P(this,t+2,t+5),P(this,t+3,t+4);return this},i.prototype.toString=function(){const e=this.length;return e===0?"":arguments.length===0?ye(this,0,e):F.apply(this,arguments)},i.prototype.toLocaleString=i.prototype.toString,i.prototype.equals=function(e){if(!i.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e?!0:i.compare(this,e)===0},i.prototype.inspect=function(){let e="";const t=_.INSPECT_MAX_BYTES;return e=this.toString("hex",0,t).replace(/(.{2})/g,"$1 ").trim(),this.length>t&&(e+=" ... "),"<Buffer "+e+">"},c&&(i.prototype[c]=i.prototype.inspect),i.prototype.compare=function(e,t,a,g,v){if(ee(e,Uint8Array)&&(e=i.from(e,e.offset,e.byteLength)),!i.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(t===void 0&&(t=0),a===void 0&&(a=e?e.length:0),g===void 0&&(g=0),v===void 0&&(v=this.length),t<0||a>e.length||g<0||v>this.length)throw new RangeError("out of range index");if(g>=v&&t>=a)return 0;if(g>=v)return-1;if(t>=a)return 1;if(t>>>=0,a>>>=0,g>>>=0,v>>>=0,this===e)return 0;let x=v-g,H=a-t;const z=Math.min(x,H),V=this.slice(g,v),X=e.slice(t,a);for(let G=0;G<z;++G)if(V[G]!==X[G]){x=V[G],H=X[G];break}return x<H?-1:H<x?1:0};function O(r,e,t,a,g){if(r.length===0)return-1;if(typeof t=="string"?(a=t,t=0):t>2147483647?t=2147483647:t<-2147483648&&(t=-2147483648),t=+t,he(t)&&(t=g?0:r.length-1),t<0&&(t=r.length+t),t>=r.length){if(g)return-1;t=r.length-1}else if(t<0)if(g)t=0;else return-1;if(typeof e=="string"&&(e=i.from(e,a)),i.isBuffer(e))return e.length===0?-1:D(r,e,t,a,g);if(typeof e=="number")return e=e&255,typeof Uint8Array.prototype.indexOf=="function"?g?Uint8Array.prototype.indexOf.call(r,e,t):Uint8Array.prototype.lastIndexOf.call(r,e,t):D(r,[e],t,a,g);throw new TypeError("val must be string, number or Buffer")}function D(r,e,t,a,g){let v=1,x=r.length,H=e.length;if(a!==void 0&&(a=String(a).toLowerCase(),a==="ucs2"||a==="ucs-2"||a==="utf16le"||a==="utf-16le")){if(r.length<2||e.length<2)return-1;v=2,x/=2,H/=2,t/=2}function z(X,G){return v===1?X[G]:X.readUInt16BE(G*v)}let V;if(g){let X=-1;for(V=t;V<x;V++)if(z(r,V)===z(e,X===-1?0:V-X)){if(X===-1&&(X=V),V-X+1===H)return X*v}else X!==-1&&(V-=V-X),X=-1}else for(t+H>x&&(t=x-H),V=t;V>=0;V--){let X=!0;for(let G=0;G<H;G++)if(z(r,V+G)!==z(e,G)){X=!1;break}if(X)return V}return-1}i.prototype.includes=function(e,t,a){return this.indexOf(e,t,a)!==-1},i.prototype.indexOf=function(e,t,a){return O(this,e,t,a,!0)},i.prototype.lastIndexOf=function(e,t,a){return O(this,e,t,a,!1)};function L(r,e,t,a){t=Number(t)||0;const g=r.length-t;a?(a=Number(a),a>g&&(a=g)):a=g;const v=e.length;a>v/2&&(a=v/2);let x;for(x=0;x<a;++x){const H=parseInt(e.substr(x*2,2),16);if(he(H))return x;r[t+x]=H}return x}function U(r,e,t,a){return Re(j(e,r.length-t),r,t,a)}function J(r,e,t,a){return Re(ue(e),r,t,a)}function se(r,e,t,a){return Re(Te(e),r,t,a)}function Be(r,e,t,a){return Re(Ee(e,r.length-t),r,t,a)}i.prototype.write=function(e,t,a,g){if(t===void 0)g="utf8",a=this.length,t=0;else if(a===void 0&&typeof t=="string")g=t,a=this.length,t=0;else if(isFinite(t))t=t>>>0,isFinite(a)?(a=a>>>0,g===void 0&&(g="utf8")):(g=a,a=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const v=this.length-t;if((a===void 0||a>v)&&(a=v),e.length>0&&(a<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");g||(g="utf8");let x=!1;for(;;)switch(g){case"hex":return L(this,e,t,a);case"utf8":case"utf-8":return U(this,e,t,a);case"ascii":case"latin1":case"binary":return J(this,e,t,a);case"base64":return se(this,e,t,a);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Be(this,e,t,a);default:if(x)throw new TypeError("Unknown encoding: "+g);g=(""+g).toLowerCase(),x=!0}},i.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function ae(r,e,t){return e===0&&t===r.length?n.fromByteArray(r):n.fromByteArray(r.slice(e,t))}function ye(r,e,t){t=Math.min(r.length,t);const a=[];let g=e;for(;g<t;){const v=r[g];let x=null,H=v>239?4:v>223?3:v>191?2:1;if(g+H<=t){let z,V,X,G;switch(H){case 1:v<128&&(x=v);break;case 2:z=r[g+1],(z&192)===128&&(G=(v&31)<<6|z&63,G>127&&(x=G));break;case 3:z=r[g+1],V=r[g+2],(z&192)===128&&(V&192)===128&&(G=(v&15)<<12|(z&63)<<6|V&63,G>2047&&(G<55296||G>57343)&&(x=G));break;case 4:z=r[g+1],V=r[g+2],X=r[g+3],(z&192)===128&&(V&192)===128&&(X&192)===128&&(G=(v&15)<<18|(z&63)<<12|(V&63)<<6|X&63,G>65535&&G<1114112&&(x=G))}}x===null?(x=65533,H=1):x>65535&&(x-=65536,a.push(x>>>10&1023|55296),x=56320|x&1023),a.push(x),g+=H}return Ae(a)}const ce=4096;function Ae(r){const e=r.length;if(e<=ce)return String.fromCharCode.apply(String,r);let t="",a=0;for(;a<e;)t+=String.fromCharCode.apply(String,r.slice(a,a+=ce));return t}function ie(r,e,t){let a="";t=Math.min(r.length,t);for(let g=e;g<t;++g)a+=String.fromCharCode(r[g]&127);return a}function me(r,e,t){let a="";t=Math.min(r.length,t);for(let g=e;g<t;++g)a+=String.fromCharCode(r[g]);return a}function le(r,e,t){const a=r.length;(!e||e<0)&&(e=0),(!t||t<0||t>a)&&(t=a);let g="";for(let v=e;v<t;++v)g+=Ie[r[v]];return g}function we(r,e,t){const a=r.slice(e,t);let g="";for(let v=0;v<a.length-1;v+=2)g+=String.fromCharCode(a[v]+a[v+1]*256);return g}i.prototype.slice=function(e,t){const a=this.length;e=~~e,t=t===void 0?a:~~t,e<0?(e+=a,e<0&&(e=0)):e>a&&(e=a),t<0?(t+=a,t<0&&(t=0)):t>a&&(t=a),t<e&&(t=e);const g=this.subarray(e,t);return Object.setPrototypeOf(g,i.prototype),g};function K(r,e,t){if(r%1!==0||r<0)throw new RangeError("offset is not uint");if(r+e>t)throw new RangeError("Trying to access beyond buffer length")}i.prototype.readUintLE=i.prototype.readUIntLE=function(e,t,a){e=e>>>0,t=t>>>0,a||K(e,t,this.length);let g=this[e],v=1,x=0;for(;++x<t&&(v*=256);)g+=this[e+x]*v;return g},i.prototype.readUintBE=i.prototype.readUIntBE=function(e,t,a){e=e>>>0,t=t>>>0,a||K(e,t,this.length);let g=this[e+--t],v=1;for(;t>0&&(v*=256);)g+=this[e+--t]*v;return g},i.prototype.readUint8=i.prototype.readUInt8=function(e,t){return e=e>>>0,t||K(e,1,this.length),this[e]},i.prototype.readUint16LE=i.prototype.readUInt16LE=function(e,t){return e=e>>>0,t||K(e,2,this.length),this[e]|this[e+1]<<8},i.prototype.readUint16BE=i.prototype.readUInt16BE=function(e,t){return e=e>>>0,t||K(e,2,this.length),this[e]<<8|this[e+1]},i.prototype.readUint32LE=i.prototype.readUInt32LE=function(e,t){return e=e>>>0,t||K(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+this[e+3]*16777216},i.prototype.readUint32BE=i.prototype.readUInt32BE=function(e,t){return e=e>>>0,t||K(e,4,this.length),this[e]*16777216+(this[e+1]<<16|this[e+2]<<8|this[e+3])},i.prototype.readBigUInt64LE=te(function(e){e=e>>>0,N(e,"offset");const t=this[e],a=this[e+7];(t===void 0||a===void 0)&&M(e,this.length-8);const g=t+this[++e]*2**8+this[++e]*2**16+this[++e]*2**24,v=this[++e]+this[++e]*2**8+this[++e]*2**16+a*2**24;return BigInt(g)+(BigInt(v)<<BigInt(32))}),i.prototype.readBigUInt64BE=te(function(e){e=e>>>0,N(e,"offset");const t=this[e],a=this[e+7];(t===void 0||a===void 0)&&M(e,this.length-8);const g=t*2**24+this[++e]*2**16+this[++e]*2**8+this[++e],v=this[++e]*2**24+this[++e]*2**16+this[++e]*2**8+a;return(BigInt(g)<<BigInt(32))+BigInt(v)}),i.prototype.readIntLE=function(e,t,a){e=e>>>0,t=t>>>0,a||K(e,t,this.length);let g=this[e],v=1,x=0;for(;++x<t&&(v*=256);)g+=this[e+x]*v;return v*=128,g>=v&&(g-=Math.pow(2,8*t)),g},i.prototype.readIntBE=function(e,t,a){e=e>>>0,t=t>>>0,a||K(e,t,this.length);let g=t,v=1,x=this[e+--g];for(;g>0&&(v*=256);)x+=this[e+--g]*v;return v*=128,x>=v&&(x-=Math.pow(2,8*t)),x},i.prototype.readInt8=function(e,t){return e=e>>>0,t||K(e,1,this.length),this[e]&128?(255-this[e]+1)*-1:this[e]},i.prototype.readInt16LE=function(e,t){e=e>>>0,t||K(e,2,this.length);const a=this[e]|this[e+1]<<8;return a&32768?a|4294901760:a},i.prototype.readInt16BE=function(e,t){e=e>>>0,t||K(e,2,this.length);const a=this[e+1]|this[e]<<8;return a&32768?a|4294901760:a},i.prototype.readInt32LE=function(e,t){return e=e>>>0,t||K(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},i.prototype.readInt32BE=function(e,t){return e=e>>>0,t||K(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},i.prototype.readBigInt64LE=te(function(e){e=e>>>0,N(e,"offset");const t=this[e],a=this[e+7];(t===void 0||a===void 0)&&M(e,this.length-8);const g=this[e+4]+this[e+5]*2**8+this[e+6]*2**16+(a<<24);return(BigInt(g)<<BigInt(32))+BigInt(t+this[++e]*2**8+this[++e]*2**16+this[++e]*2**24)}),i.prototype.readBigInt64BE=te(function(e){e=e>>>0,N(e,"offset");const t=this[e],a=this[e+7];(t===void 0||a===void 0)&&M(e,this.length-8);const g=(t<<24)+this[++e]*2**16+this[++e]*2**8+this[++e];return(BigInt(g)<<BigInt(32))+BigInt(this[++e]*2**24+this[++e]*2**16+this[++e]*2**8+a)}),i.prototype.readFloatLE=function(e,t){return e=e>>>0,t||K(e,4,this.length),o.read(this,e,!0,23,4)},i.prototype.readFloatBE=function(e,t){return e=e>>>0,t||K(e,4,this.length),o.read(this,e,!1,23,4)},i.prototype.readDoubleLE=function(e,t){return e=e>>>0,t||K(e,8,this.length),o.read(this,e,!0,52,8)},i.prototype.readDoubleBE=function(e,t){return e=e>>>0,t||K(e,8,this.length),o.read(this,e,!1,52,8)};function Q(r,e,t,a,g,v){if(!i.isBuffer(r))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>g||e<v)throw new RangeError('"value" argument is out of bounds');if(t+a>r.length)throw new RangeError("Index out of range")}i.prototype.writeUintLE=i.prototype.writeUIntLE=function(e,t,a,g){if(e=+e,t=t>>>0,a=a>>>0,!g){const H=Math.pow(2,8*a)-1;Q(this,e,t,a,H,0)}let v=1,x=0;for(this[t]=e&255;++x<a&&(v*=256);)this[t+x]=e/v&255;return t+a},i.prototype.writeUintBE=i.prototype.writeUIntBE=function(e,t,a,g){if(e=+e,t=t>>>0,a=a>>>0,!g){const H=Math.pow(2,8*a)-1;Q(this,e,t,a,H,0)}let v=a-1,x=1;for(this[t+v]=e&255;--v>=0&&(x*=256);)this[t+v]=e/x&255;return t+a},i.prototype.writeUint8=i.prototype.writeUInt8=function(e,t,a){return e=+e,t=t>>>0,a||Q(this,e,t,1,255,0),this[t]=e&255,t+1},i.prototype.writeUint16LE=i.prototype.writeUInt16LE=function(e,t,a){return e=+e,t=t>>>0,a||Q(this,e,t,2,65535,0),this[t]=e&255,this[t+1]=e>>>8,t+2},i.prototype.writeUint16BE=i.prototype.writeUInt16BE=function(e,t,a){return e=+e,t=t>>>0,a||Q(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=e&255,t+2},i.prototype.writeUint32LE=i.prototype.writeUInt32LE=function(e,t,a){return e=+e,t=t>>>0,a||Q(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=e&255,t+4},i.prototype.writeUint32BE=i.prototype.writeUInt32BE=function(e,t,a){return e=+e,t=t>>>0,a||Q(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=e&255,t+4};function re(r,e,t,a,g){h(e,a,g,r,t,7);let v=Number(e&BigInt(4294967295));r[t++]=v,v=v>>8,r[t++]=v,v=v>>8,r[t++]=v,v=v>>8,r[t++]=v;let x=Number(e>>BigInt(32)&BigInt(4294967295));return r[t++]=x,x=x>>8,r[t++]=x,x=x>>8,r[t++]=x,x=x>>8,r[t++]=x,t}function _e(r,e,t,a,g){h(e,a,g,r,t,7);let v=Number(e&BigInt(4294967295));r[t+7]=v,v=v>>8,r[t+6]=v,v=v>>8,r[t+5]=v,v=v>>8,r[t+4]=v;let x=Number(e>>BigInt(32)&BigInt(4294967295));return r[t+3]=x,x=x>>8,r[t+2]=x,x=x>>8,r[t+1]=x,x=x>>8,r[t]=x,t+8}i.prototype.writeBigUInt64LE=te(function(e,t=0){return re(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))}),i.prototype.writeBigUInt64BE=te(function(e,t=0){return _e(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))}),i.prototype.writeIntLE=function(e,t,a,g){if(e=+e,t=t>>>0,!g){const z=Math.pow(2,8*a-1);Q(this,e,t,a,z-1,-z)}let v=0,x=1,H=0;for(this[t]=e&255;++v<a&&(x*=256);)e<0&&H===0&&this[t+v-1]!==0&&(H=1),this[t+v]=(e/x>>0)-H&255;return t+a},i.prototype.writeIntBE=function(e,t,a,g){if(e=+e,t=t>>>0,!g){const z=Math.pow(2,8*a-1);Q(this,e,t,a,z-1,-z)}let v=a-1,x=1,H=0;for(this[t+v]=e&255;--v>=0&&(x*=256);)e<0&&H===0&&this[t+v+1]!==0&&(H=1),this[t+v]=(e/x>>0)-H&255;return t+a},i.prototype.writeInt8=function(e,t,a){return e=+e,t=t>>>0,a||Q(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=e&255,t+1},i.prototype.writeInt16LE=function(e,t,a){return e=+e,t=t>>>0,a||Q(this,e,t,2,32767,-32768),this[t]=e&255,this[t+1]=e>>>8,t+2},i.prototype.writeInt16BE=function(e,t,a){return e=+e,t=t>>>0,a||Q(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=e&255,t+2},i.prototype.writeInt32LE=function(e,t,a){return e=+e,t=t>>>0,a||Q(this,e,t,4,2147483647,-2147483648),this[t]=e&255,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},i.prototype.writeInt32BE=function(e,t,a){return e=+e,t=t>>>0,a||Q(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=e&255,t+4},i.prototype.writeBigInt64LE=te(function(e,t=0){return re(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),i.prototype.writeBigInt64BE=te(function(e,t=0){return _e(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function be(r,e,t,a,g,v){if(t+a>r.length)throw new RangeError("Index out of range");if(t<0)throw new RangeError("Index out of range")}function A(r,e,t,a,g){return e=+e,t=t>>>0,g||be(r,e,t,4),o.write(r,e,t,a,23,4),t+4}i.prototype.writeFloatLE=function(e,t,a){return A(this,e,t,!0,a)},i.prototype.writeFloatBE=function(e,t,a){return A(this,e,t,!1,a)};function R(r,e,t,a,g){return e=+e,t=t>>>0,g||be(r,e,t,8),o.write(r,e,t,a,52,8),t+8}i.prototype.writeDoubleLE=function(e,t,a){return R(this,e,t,!0,a)},i.prototype.writeDoubleBE=function(e,t,a){return R(this,e,t,!1,a)},i.prototype.copy=function(e,t,a,g){if(!i.isBuffer(e))throw new TypeError("argument should be a Buffer");if(a||(a=0),!g&&g!==0&&(g=this.length),t>=e.length&&(t=e.length),t||(t=0),g>0&&g<a&&(g=a),g===a||e.length===0||this.length===0)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(a<0||a>=this.length)throw new RangeError("Index out of range");if(g<0)throw new RangeError("sourceEnd out of bounds");g>this.length&&(g=this.length),e.length-t<g-a&&(g=e.length-t+a);const v=g-a;return this===e&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(t,a,g):Uint8Array.prototype.set.call(e,this.subarray(a,g),t),v},i.prototype.fill=function(e,t,a,g){if(typeof e=="string"){if(typeof t=="string"?(g=t,t=0,a=this.length):typeof a=="string"&&(g=a,a=this.length),g!==void 0&&typeof g!="string")throw new TypeError("encoding must be a string");if(typeof g=="string"&&!i.isEncoding(g))throw new TypeError("Unknown encoding: "+g);if(e.length===1){const x=e.charCodeAt(0);(g==="utf8"&&x<128||g==="latin1")&&(e=x)}}else typeof e=="number"?e=e&255:typeof e=="boolean"&&(e=Number(e));if(t<0||this.length<t||this.length<a)throw new RangeError("Out of range index");if(a<=t)return this;t=t>>>0,a=a===void 0?this.length:a>>>0,e||(e=0);let v;if(typeof e=="number")for(v=t;v<a;++v)this[v]=e;else{const x=i.isBuffer(e)?e:i.from(e,g),H=x.length;if(H===0)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(v=0;v<a-t;++v)this[v+t]=x[v%H]}return this};const k={};function $(r,e,t){k[r]=class extends t{constructor(){super(),Object.defineProperty(this,"message",{value:e.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${r}]`,this.stack,delete this.name}get code(){return r}set code(g){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:g,writable:!0})}toString(){return`${this.name} [${r}]: ${this.message}`}}}$("ERR_BUFFER_OUT_OF_BOUNDS",function(r){return r?`${r} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),$("ERR_INVALID_ARG_TYPE",function(r,e){return`The "${r}" argument must be of type number. Received type ${typeof e}`},TypeError),$("ERR_OUT_OF_RANGE",function(r,e,t){let a=`The value of "${r}" is out of range.`,g=t;return Number.isInteger(t)&&Math.abs(t)>2**32?g=q(String(t)):typeof t=="bigint"&&(g=String(t),(t>BigInt(2)**BigInt(32)||t<-(BigInt(2)**BigInt(32)))&&(g=q(g)),g+="n"),a+=` It must be ${e}. Received ${g}`,a},RangeError);function q(r){let e="",t=r.length;const a=r[0]==="-"?1:0;for(;t>=a+4;t-=3)e=`_${r.slice(t-3,t)}${e}`;return`${r.slice(0,t)}${e}`}function u(r,e,t){N(e,"offset"),(r[e]===void 0||r[e+t]===void 0)&&M(e,r.length-(t+1))}function h(r,e,t,a,g,v){if(r>t||r<e){const x=typeof e=="bigint"?"n":"";let H;throw e===0||e===BigInt(0)?H=`>= 0${x} and < 2${x} ** ${(v+1)*8}${x}`:H=`>= -(2${x} ** ${(v+1)*8-1}${x}) and < 2 ** ${(v+1)*8-1}${x}`,new k.ERR_OUT_OF_RANGE("value",H,r)}u(a,g,v)}function N(r,e){if(typeof r!="number")throw new k.ERR_INVALID_ARG_TYPE(e,"number",r)}function M(r,e,t){throw Math.floor(r)!==r?(N(r,t),new k.ERR_OUT_OF_RANGE("offset","an integer",r)):e<0?new k.ERR_BUFFER_OUT_OF_BOUNDS:new k.ERR_OUT_OF_RANGE("offset",`>= 0 and <= ${e}`,r)}const Y=/[^+/0-9A-Za-z-_]/g;function W(r){if(r=r.split("=")[0],r=r.trim().replace(Y,""),r.length<2)return"";for(;r.length%4!==0;)r=r+"=";return r}function j(r,e){e=e||1/0;let t;const a=r.length;let g=null;const v=[];for(let x=0;x<a;++x){if(t=r.charCodeAt(x),t>55295&&t<57344){if(!g){if(t>56319){(e-=3)>-1&&v.push(239,191,189);continue}else if(x+1===a){(e-=3)>-1&&v.push(239,191,189);continue}g=t;continue}if(t<56320){(e-=3)>-1&&v.push(239,191,189),g=t;continue}t=(g-55296<<10|t-56320)+65536}else g&&(e-=3)>-1&&v.push(239,191,189);if(g=null,t<128){if((e-=1)<0)break;v.push(t)}else if(t<2048){if((e-=2)<0)break;v.push(t>>6|192,t&63|128)}else if(t<65536){if((e-=3)<0)break;v.push(t>>12|224,t>>6&63|128,t&63|128)}else if(t<1114112){if((e-=4)<0)break;v.push(t>>18|240,t>>12&63|128,t>>6&63|128,t&63|128)}else throw new Error("Invalid code point")}return v}function ue(r){const e=[];for(let t=0;t<r.length;++t)e.push(r.charCodeAt(t)&255);return e}function Ee(r,e){let t,a,g;const v=[];for(let x=0;x<r.length&&!((e-=2)<0);++x)t=r.charCodeAt(x),a=t>>8,g=t%256,v.push(g),v.push(a);return v}function Te(r){return n.toByteArray(W(r))}function Re(r,e,t,a){let g;for(g=0;g<a&&!(g+t>=e.length||g>=r.length);++g)e[g+t]=r[g];return g}function ee(r,e){return r instanceof e||r!=null&&r.constructor!=null&&r.constructor.name!=null&&r.constructor.name===e.name}function he(r){return r!==r}const Ie=function(){const r="0123456789abcdef",e=new Array(256);for(let t=0;t<16;++t){const a=t*16;for(let g=0;g<16;++g)e[a+g]=r[t]+r[g]}return e}();function te(r){return typeof BigInt>"u"?de:r}function de(){throw new Error("BigInt not supported")}}(Ve)),Ve}/*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */var Rt;function Vt(){return Rt||(Rt=1,function(_,n){var o=Fe(),c=o.Buffer;function f(p,i){for(var b in p)i[b]=p[b]}c.from&&c.alloc&&c.allocUnsafe&&c.allocUnsafeSlow?_.exports=o:(f(o,n),n.Buffer=l);function l(p,i,b){return c(p,i,b)}l.prototype=Object.create(c.prototype),f(c,l),l.from=function(p,i,b){if(typeof p=="number")throw new TypeError("Argument must not be a number");return c(p,i,b)},l.alloc=function(p,i,b){if(typeof p!="number")throw new TypeError("Argument must be a number");var S=c(p);return i!==void 0?typeof b=="string"?S.fill(i,b):S.fill(i):S.fill(0),S},l.allocUnsafe=function(p){if(typeof p!="number")throw new TypeError("Argument must be a number");return c(p)},l.allocUnsafeSlow=function(p){if(typeof p!="number")throw new TypeError("Argument must be a number");return o.SlowBuffer(p)}}(Le,Le.exports)),Le.exports}var Ct;function gr(){if(Ct)return Me.exports;Ct=1;var _=65536,n=4294967295;function o(){throw new Error(`Secure random number generation is not supported by this browser.
Use Chrome, Firefox or Internet Explorer 11`)}var c=Vt().Buffer,f=oe.crypto||oe.msCrypto;f&&f.getRandomValues?Me.exports=l:Me.exports=o;function l(p,i){if(p>n)throw new RangeError("requested too many random bytes");var b=c.allocUnsafe(p);if(p>0)if(p>_)for(var S=0;S<p;S+=_)f.getRandomValues(b.slice(S,S+_));else f.getRandomValues(b);return typeof i=="function"?process.nextTick(function(){i(null,b)}):b}return Me.exports}var $e={exports:{}};const yr={},mr=Object.freeze(Object.defineProperty({__proto__:null,default:yr},Symbol.toStringTag,{value:"Module"})),He=lr(mr);var Je,vt;function Jt(){return vt||(vt=1,Je=He.EventEmitter),Je}var Ke,St;function wr(){if(St)return Ke;St=1;function _(s,m){var y=Object.keys(s);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(s);m&&(d=d.filter(function(w){return Object.getOwnPropertyDescriptor(s,w).enumerable})),y.push.apply(y,d)}return y}function n(s){for(var m=1;m<arguments.length;m++){var y=arguments[m]!=null?arguments[m]:{};m%2?_(Object(y),!0).forEach(function(d){o(s,d,y[d])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(y)):_(Object(y)).forEach(function(d){Object.defineProperty(s,d,Object.getOwnPropertyDescriptor(y,d))})}return s}function o(s,m,y){return m=p(m),m in s?Object.defineProperty(s,m,{value:y,enumerable:!0,configurable:!0,writable:!0}):s[m]=y,s}function c(s,m){if(!(s instanceof m))throw new TypeError("Cannot call a class as a function")}function f(s,m){for(var y=0;y<m.length;y++){var d=m[y];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(s,p(d.key),d)}}function l(s,m,y){return m&&f(s.prototype,m),Object.defineProperty(s,"prototype",{writable:!1}),s}function p(s){var m=i(s,"string");return typeof m=="symbol"?m:String(m)}function i(s,m){if(typeof s!="object"||s===null)return s;var y=s[Symbol.toPrimitive];if(y!==void 0){var d=y.call(s,m);if(typeof d!="object")return d;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(s)}var b=Fe(),S=b.Buffer,B=He,E=B.inspect,C=E&&E.custom||"inspect";function T(s,m,y){S.prototype.copy.call(s,m,y)}return Ke=function(){function s(){c(this,s),this.head=null,this.tail=null,this.length=0}return l(s,[{key:"push",value:function(y){var d={data:y,next:null};this.length>0?this.tail.next=d:this.head=d,this.tail=d,++this.length}},{key:"unshift",value:function(y){var d={data:y,next:this.head};this.length===0&&(this.tail=d),this.head=d,++this.length}},{key:"shift",value:function(){if(this.length!==0){var y=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,y}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(y){if(this.length===0)return"";for(var d=this.head,w=""+d.data;d=d.next;)w+=y+d.data;return w}},{key:"concat",value:function(y){if(this.length===0)return S.alloc(0);for(var d=S.allocUnsafe(y>>>0),w=this.head,I=0;w;)T(w.data,d,I),I+=w.data.length,w=w.next;return d}},{key:"consume",value:function(y,d){var w;return y<this.head.data.length?(w=this.head.data.slice(0,y),this.head.data=this.head.data.slice(y)):y===this.head.data.length?w=this.shift():w=d?this._getString(y):this._getBuffer(y),w}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(y){var d=this.head,w=1,I=d.data;for(y-=I.length;d=d.next;){var F=d.data,P=y>F.length?F.length:y;if(P===F.length?I+=F:I+=F.slice(0,y),y-=P,y===0){P===F.length?(++w,d.next?this.head=d.next:this.head=this.tail=null):(this.head=d,d.data=F.slice(P));break}++w}return this.length-=w,I}},{key:"_getBuffer",value:function(y){var d=S.allocUnsafe(y),w=this.head,I=1;for(w.data.copy(d),y-=w.data.length;w=w.next;){var F=w.data,P=y>F.length?F.length:y;if(F.copy(d,d.length-y,0,P),y-=P,y===0){P===F.length?(++I,w.next?this.head=w.next:this.head=this.tail=null):(this.head=w,w.data=F.slice(P));break}++I}return this.length-=I,d}},{key:C,value:function(y,d){return E(this,n(n({},d),{},{depth:0,customInspect:!1}))}}]),s}(),Ke}var ze,Bt;function Kt(){if(Bt)return ze;Bt=1;function _(p,i){var b=this,S=this._readableState&&this._readableState.destroyed,B=this._writableState&&this._writableState.destroyed;return S||B?(i?i(p):p&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,process.nextTick(f,this,p)):process.nextTick(f,this,p)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(p||null,function(E){!i&&E?b._writableState?b._writableState.errorEmitted?process.nextTick(o,b):(b._writableState.errorEmitted=!0,process.nextTick(n,b,E)):process.nextTick(n,b,E):i?(process.nextTick(o,b),i(E)):process.nextTick(o,b)}),this)}function n(p,i){f(p,i),o(p)}function o(p){p._writableState&&!p._writableState.emitClose||p._readableState&&!p._readableState.emitClose||p.emit("close")}function c(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}function f(p,i){p.emit("error",i)}function l(p,i){var b=p._readableState,S=p._writableState;b&&b.autoDestroy||S&&S.autoDestroy?p.destroy(i):p.emit("error",i)}return ze={destroy:_,undestroy:c,errorOrDestroy:l},ze}var Xe={},At;function Se(){if(At)return Xe;At=1;function _(i,b){i.prototype=Object.create(b.prototype),i.prototype.constructor=i,i.__proto__=b}var n={};function o(i,b,S){S||(S=Error);function B(C,T,s){return typeof b=="string"?b:b(C,T,s)}var E=function(C){_(T,C);function T(s,m,y){return C.call(this,B(s,m,y))||this}return T}(S);E.prototype.name=S.name,E.prototype.code=i,n[i]=E}function c(i,b){if(Array.isArray(i)){var S=i.length;return i=i.map(function(B){return String(B)}),S>2?"one of ".concat(b," ").concat(i.slice(0,S-1).join(", "),", or ")+i[S-1]:S===2?"one of ".concat(b," ").concat(i[0]," or ").concat(i[1]):"of ".concat(b," ").concat(i[0])}else return"of ".concat(b," ").concat(String(i))}function f(i,b,S){return i.substr(0,b.length)===b}function l(i,b,S){return(S===void 0||S>i.length)&&(S=i.length),i.substring(S-b.length,S)===b}function p(i,b,S){return typeof S!="number"&&(S=0),S+b.length>i.length?!1:i.indexOf(b,S)!==-1}return o("ERR_INVALID_OPT_VALUE",function(i,b){return'The value "'+b+'" is invalid for option "'+i+'"'},TypeError),o("ERR_INVALID_ARG_TYPE",function(i,b,S){var B;typeof b=="string"&&f(b,"not ")?(B="must not be",b=b.replace(/^not /,"")):B="must be";var E;if(l(i," argument"))E="The ".concat(i," ").concat(B," ").concat(c(b,"type"));else{var C=p(i,".")?"property":"argument";E='The "'.concat(i,'" ').concat(C," ").concat(B," ").concat(c(b,"type"))}return E+=". Received type ".concat(typeof S),E},TypeError),o("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),o("ERR_METHOD_NOT_IMPLEMENTED",function(i){return"The "+i+" method is not implemented"}),o("ERR_STREAM_PREMATURE_CLOSE","Premature close"),o("ERR_STREAM_DESTROYED",function(i){return"Cannot call "+i+" after a stream was destroyed"}),o("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),o("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),o("ERR_STREAM_WRITE_AFTER_END","write after end"),o("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),o("ERR_UNKNOWN_ENCODING",function(i){return"Unknown encoding: "+i},TypeError),o("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),Xe.codes=n,Xe}var Qe,Tt;function zt(){if(Tt)return Qe;Tt=1;var _=Se().codes.ERR_INVALID_OPT_VALUE;function n(c,f,l){return c.highWaterMark!=null?c.highWaterMark:f?c[l]:null}function o(c,f,l,p){var i=n(f,p,l);if(i!=null){if(!(isFinite(i)&&Math.floor(i)===i)||i<0){var b=p?l:"highWaterMark";throw new _(b,i)}return Math.floor(i)}return c.objectMode?16:16*1024}return Qe={getHighWaterMark:o},Qe}var qe={exports:{}},It;function ke(){return It||(It=1,typeof Object.create=="function"?qe.exports=function(n,o){o&&(n.super_=o,n.prototype=Object.create(o.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}))}:qe.exports=function(n,o){if(o){n.super_=o;var c=function(){};c.prototype=o.prototype,n.prototype=new c,n.prototype.constructor=n}}),qe.exports}var Ze,xt;function _r(){if(xt)return Ze;xt=1,Ze=_;function _(o,c){if(n("noDeprecation"))return o;var f=!1;function l(){if(!f){if(n("throwDeprecation"))throw new Error(c);n("traceDeprecation")?console.trace(c):console.warn(c),f=!0}return o.apply(this,arguments)}return l}function n(o){try{if(!oe.localStorage)return!1}catch{return!1}var c=oe.localStorage[o];return c==null?!1:String(c).toLowerCase()==="true"}return Ze}var et,Pt;function Xt(){if(Pt)return et;Pt=1,et=L;function _(A){var R=this;this.next=null,this.entry=null,this.finish=function(){be(R,A)}}var n;L.WritableState=O;var o={deprecate:_r()},c=Jt(),f=Fe().Buffer,l=(typeof oe<"u"?oe:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){};function p(A){return f.from(A)}function i(A){return f.isBuffer(A)||A instanceof l}var b=Kt(),S=zt(),B=S.getHighWaterMark,E=Se().codes,C=E.ERR_INVALID_ARG_TYPE,T=E.ERR_METHOD_NOT_IMPLEMENTED,s=E.ERR_MULTIPLE_CALLBACK,m=E.ERR_STREAM_CANNOT_PIPE,y=E.ERR_STREAM_DESTROYED,d=E.ERR_STREAM_NULL_VALUES,w=E.ERR_STREAM_WRITE_AFTER_END,I=E.ERR_UNKNOWN_ENCODING,F=b.errorOrDestroy;ke()(L,c);function P(){}function O(A,R,k){n=n||ve(),A=A||{},typeof k!="boolean"&&(k=R instanceof n),this.objectMode=!!A.objectMode,k&&(this.objectMode=this.objectMode||!!A.writableObjectMode),this.highWaterMark=B(this,A,"writableHighWaterMark",k),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var $=A.decodeStrings===!1;this.decodeStrings=!$,this.defaultEncoding=A.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(q){Ae(R,q)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=A.emitClose!==!1,this.autoDestroy=!!A.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new _(this)}O.prototype.getBuffer=function(){for(var R=this.bufferedRequest,k=[];R;)k.push(R),R=R.next;return k},function(){try{Object.defineProperty(O.prototype,"buffer",{get:o.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}}();var D;typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(D=Function.prototype[Symbol.hasInstance],Object.defineProperty(L,Symbol.hasInstance,{value:function(R){return D.call(this,R)?!0:this!==L?!1:R&&R._writableState instanceof O}})):D=function(R){return R instanceof this};function L(A){n=n||ve();var R=this instanceof n;if(!R&&!D.call(L,this))return new L(A);this._writableState=new O(A,this,R),this.writable=!0,A&&(typeof A.write=="function"&&(this._write=A.write),typeof A.writev=="function"&&(this._writev=A.writev),typeof A.destroy=="function"&&(this._destroy=A.destroy),typeof A.final=="function"&&(this._final=A.final)),c.call(this)}L.prototype.pipe=function(){F(this,new m)};function U(A,R){var k=new w;F(A,k),process.nextTick(R,k)}function J(A,R,k,$){var q;return k===null?q=new d:typeof k!="string"&&!R.objectMode&&(q=new C("chunk",["string","Buffer"],k)),q?(F(A,q),process.nextTick($,q),!1):!0}L.prototype.write=function(A,R,k){var $=this._writableState,q=!1,u=!$.objectMode&&i(A);return u&&!f.isBuffer(A)&&(A=p(A)),typeof R=="function"&&(k=R,R=null),u?R="buffer":R||(R=$.defaultEncoding),typeof k!="function"&&(k=P),$.ending?U(this,k):(u||J(this,$,A,k))&&($.pendingcb++,q=Be(this,$,u,A,R,k)),q},L.prototype.cork=function(){this._writableState.corked++},L.prototype.uncork=function(){var A=this._writableState;A.corked&&(A.corked--,!A.writing&&!A.corked&&!A.bufferProcessing&&A.bufferedRequest&&le(this,A))},L.prototype.setDefaultEncoding=function(R){if(typeof R=="string"&&(R=R.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((R+"").toLowerCase())>-1))throw new I(R);return this._writableState.defaultEncoding=R,this},Object.defineProperty(L.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}});function se(A,R,k){return!A.objectMode&&A.decodeStrings!==!1&&typeof R=="string"&&(R=f.from(R,k)),R}Object.defineProperty(L.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});function Be(A,R,k,$,q,u){if(!k){var h=se(R,$,q);$!==h&&(k=!0,q="buffer",$=h)}var N=R.objectMode?1:$.length;R.length+=N;var M=R.length<R.highWaterMark;if(M||(R.needDrain=!0),R.writing||R.corked){var Y=R.lastBufferedRequest;R.lastBufferedRequest={chunk:$,encoding:q,isBuf:k,callback:u,next:null},Y?Y.next=R.lastBufferedRequest:R.bufferedRequest=R.lastBufferedRequest,R.bufferedRequestCount+=1}else ae(A,R,!1,N,$,q,u);return M}function ae(A,R,k,$,q,u,h){R.writelen=$,R.writecb=h,R.writing=!0,R.sync=!0,R.destroyed?R.onwrite(new y("write")):k?A._writev(q,R.onwrite):A._write(q,u,R.onwrite),R.sync=!1}function ye(A,R,k,$,q){--R.pendingcb,k?(process.nextTick(q,$),process.nextTick(re,A,R),A._writableState.errorEmitted=!0,F(A,$)):(q($),A._writableState.errorEmitted=!0,F(A,$),re(A,R))}function ce(A){A.writing=!1,A.writecb=null,A.length-=A.writelen,A.writelen=0}function Ae(A,R){var k=A._writableState,$=k.sync,q=k.writecb;if(typeof q!="function")throw new s;if(ce(k),R)ye(A,k,$,R,q);else{var u=we(k)||A.destroyed;!u&&!k.corked&&!k.bufferProcessing&&k.bufferedRequest&&le(A,k),$?process.nextTick(ie,A,k,u,q):ie(A,k,u,q)}}function ie(A,R,k,$){k||me(A,R),R.pendingcb--,$(),re(A,R)}function me(A,R){R.length===0&&R.needDrain&&(R.needDrain=!1,A.emit("drain"))}function le(A,R){R.bufferProcessing=!0;var k=R.bufferedRequest;if(A._writev&&k&&k.next){var $=R.bufferedRequestCount,q=new Array($),u=R.corkedRequestsFree;u.entry=k;for(var h=0,N=!0;k;)q[h]=k,k.isBuf||(N=!1),k=k.next,h+=1;q.allBuffers=N,ae(A,R,!0,R.length,q,"",u.finish),R.pendingcb++,R.lastBufferedRequest=null,u.next?(R.corkedRequestsFree=u.next,u.next=null):R.corkedRequestsFree=new _(R),R.bufferedRequestCount=0}else{for(;k;){var M=k.chunk,Y=k.encoding,W=k.callback,j=R.objectMode?1:M.length;if(ae(A,R,!1,j,M,Y,W),k=k.next,R.bufferedRequestCount--,R.writing)break}k===null&&(R.lastBufferedRequest=null)}R.bufferedRequest=k,R.bufferProcessing=!1}L.prototype._write=function(A,R,k){k(new T("_write()"))},L.prototype._writev=null,L.prototype.end=function(A,R,k){var $=this._writableState;return typeof A=="function"?(k=A,A=null,R=null):typeof R=="function"&&(k=R,R=null),A!=null&&this.write(A,R),$.corked&&($.corked=1,this.uncork()),$.ending||_e(this,$,k),this},Object.defineProperty(L.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function we(A){return A.ending&&A.length===0&&A.bufferedRequest===null&&!A.finished&&!A.writing}function K(A,R){A._final(function(k){R.pendingcb--,k&&F(A,k),R.prefinished=!0,A.emit("prefinish"),re(A,R)})}function Q(A,R){!R.prefinished&&!R.finalCalled&&(typeof A._final=="function"&&!R.destroyed?(R.pendingcb++,R.finalCalled=!0,process.nextTick(K,A,R)):(R.prefinished=!0,A.emit("prefinish")))}function re(A,R){var k=we(R);if(k&&(Q(A,R),R.pendingcb===0&&(R.finished=!0,A.emit("finish"),R.autoDestroy))){var $=A._readableState;(!$||$.autoDestroy&&$.endEmitted)&&A.destroy()}return k}function _e(A,R,k){R.ending=!0,re(A,R),k&&(R.finished?process.nextTick(k):A.once("finish",k)),R.ended=!0,A.writable=!1}function be(A,R,k){var $=A.entry;for(A.entry=null;$;){var q=$.callback;R.pendingcb--,q(k),$=$.next}R.corkedRequestsFree.next=A}return Object.defineProperty(L.prototype,"destroyed",{enumerable:!1,get:function(){return this._writableState===void 0?!1:this._writableState.destroyed},set:function(R){this._writableState&&(this._writableState.destroyed=R)}}),L.prototype.destroy=b.destroy,L.prototype._undestroy=b.undestroy,L.prototype._destroy=function(A,R){R(A)},et}var tt,Nt;function ve(){if(Nt)return tt;Nt=1;var _=Object.keys||function(S){var B=[];for(var E in S)B.push(E);return B};tt=p;var n=Qt(),o=Xt();ke()(p,n);for(var c=_(o.prototype),f=0;f<c.length;f++){var l=c[f];p.prototype[l]||(p.prototype[l]=o.prototype[l])}function p(S){if(!(this instanceof p))return new p(S);n.call(this,S),o.call(this,S),this.allowHalfOpen=!0,S&&(S.readable===!1&&(this.readable=!1),S.writable===!1&&(this.writable=!1),S.allowHalfOpen===!1&&(this.allowHalfOpen=!1,this.once("end",i)))}Object.defineProperty(p.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(p.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(p.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function i(){this._writableState.ended||process.nextTick(b,this)}function b(S){S.end()}return Object.defineProperty(p.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set:function(B){this._readableState===void 0||this._writableState===void 0||(this._readableState.destroyed=B,this._writableState.destroyed=B)}}),tt}var rt={},Ft;function kt(){if(Ft)return rt;Ft=1;var _=Vt().Buffer,n=_.isEncoding||function(d){switch(d=""+d,d&&d.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function o(d){if(!d)return"utf8";for(var w;;)switch(d){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return d;default:if(w)return;d=(""+d).toLowerCase(),w=!0}}function c(d){var w=o(d);if(typeof w!="string"&&(_.isEncoding===n||!n(d)))throw new Error("Unknown encoding: "+d);return w||d}rt.StringDecoder=f;function f(d){this.encoding=c(d);var w;switch(this.encoding){case"utf16le":this.text=E,this.end=C,w=4;break;case"utf8":this.fillLast=b,w=4;break;case"base64":this.text=T,this.end=s,w=3;break;default:this.write=m,this.end=y;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=_.allocUnsafe(w)}f.prototype.write=function(d){if(d.length===0)return"";var w,I;if(this.lastNeed){if(w=this.fillLast(d),w===void 0)return"";I=this.lastNeed,this.lastNeed=0}else I=0;return I<d.length?w?w+this.text(d,I):this.text(d,I):w||""},f.prototype.end=B,f.prototype.text=S,f.prototype.fillLast=function(d){if(this.lastNeed<=d.length)return d.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);d.copy(this.lastChar,this.lastTotal-this.lastNeed,0,d.length),this.lastNeed-=d.length};function l(d){return d<=127?0:d>>5===6?2:d>>4===14?3:d>>3===30?4:d>>6===2?-1:-2}function p(d,w,I){var F=w.length-1;if(F<I)return 0;var P=l(w[F]);return P>=0?(P>0&&(d.lastNeed=P-1),P):--F<I||P===-2?0:(P=l(w[F]),P>=0?(P>0&&(d.lastNeed=P-2),P):--F<I||P===-2?0:(P=l(w[F]),P>=0?(P>0&&(P===2?P=0:d.lastNeed=P-3),P):0))}function i(d,w,I){if((w[0]&192)!==128)return d.lastNeed=0,"�";if(d.lastNeed>1&&w.length>1){if((w[1]&192)!==128)return d.lastNeed=1,"�";if(d.lastNeed>2&&w.length>2&&(w[2]&192)!==128)return d.lastNeed=2,"�"}}function b(d){var w=this.lastTotal-this.lastNeed,I=i(this,d);if(I!==void 0)return I;if(this.lastNeed<=d.length)return d.copy(this.lastChar,w,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);d.copy(this.lastChar,w,0,d.length),this.lastNeed-=d.length}function S(d,w){var I=p(this,d,w);if(!this.lastNeed)return d.toString("utf8",w);this.lastTotal=I;var F=d.length-(I-this.lastNeed);return d.copy(this.lastChar,0,F),d.toString("utf8",w,F)}function B(d){var w=d&&d.length?this.write(d):"";return this.lastNeed?w+"�":w}function E(d,w){if((d.length-w)%2===0){var I=d.toString("utf16le",w);if(I){var F=I.charCodeAt(I.length-1);if(F>=55296&&F<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=d[d.length-2],this.lastChar[1]=d[d.length-1],I.slice(0,-1)}return I}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=d[d.length-1],d.toString("utf16le",w,d.length-1)}function C(d){var w=d&&d.length?this.write(d):"";if(this.lastNeed){var I=this.lastTotal-this.lastNeed;return w+this.lastChar.toString("utf16le",0,I)}return w}function T(d,w){var I=(d.length-w)%3;return I===0?d.toString("base64",w):(this.lastNeed=3-I,this.lastTotal=3,I===1?this.lastChar[0]=d[d.length-1]:(this.lastChar[0]=d[d.length-2],this.lastChar[1]=d[d.length-1]),d.toString("base64",w,d.length-I))}function s(d){var w=d&&d.length?this.write(d):"";return this.lastNeed?w+this.lastChar.toString("base64",0,3-this.lastNeed):w}function m(d){return d.toString(this.encoding)}function y(d){return d&&d.length?this.write(d):""}return rt}var nt,Ot;function ft(){if(Ot)return nt;Ot=1;var _=Se().codes.ERR_STREAM_PREMATURE_CLOSE;function n(l){var p=!1;return function(){if(!p){p=!0;for(var i=arguments.length,b=new Array(i),S=0;S<i;S++)b[S]=arguments[S];l.apply(this,b)}}}function o(){}function c(l){return l.setHeader&&typeof l.abort=="function"}function f(l,p,i){if(typeof p=="function")return f(l,null,p);p||(p={}),i=n(i||o);var b=p.readable||p.readable!==!1&&l.readable,S=p.writable||p.writable!==!1&&l.writable,B=function(){l.writable||C()},E=l._writableState&&l._writableState.finished,C=function(){S=!1,E=!0,b||i.call(l)},T=l._readableState&&l._readableState.endEmitted,s=function(){b=!1,T=!0,S||i.call(l)},m=function(I){i.call(l,I)},y=function(){var I;if(b&&!T)return(!l._readableState||!l._readableState.ended)&&(I=new _),i.call(l,I);if(S&&!E)return(!l._writableState||!l._writableState.ended)&&(I=new _),i.call(l,I)},d=function(){l.req.on("finish",C)};return c(l)?(l.on("complete",C),l.on("abort",y),l.req?d():l.on("request",d)):S&&!l._writableState&&(l.on("end",B),l.on("close",B)),l.on("end",s),l.on("finish",C),p.error!==!1&&l.on("error",m),l.on("close",y),function(){l.removeListener("complete",C),l.removeListener("abort",y),l.removeListener("request",d),l.req&&l.req.removeListener("finish",C),l.removeListener("end",B),l.removeListener("close",B),l.removeListener("finish",C),l.removeListener("end",s),l.removeListener("error",m),l.removeListener("close",y)}}return nt=f,nt}var it,Dt;function br(){if(Dt)return it;Dt=1;var _;function n(I,F,P){return F=o(F),F in I?Object.defineProperty(I,F,{value:P,enumerable:!0,configurable:!0,writable:!0}):I[F]=P,I}function o(I){var F=c(I,"string");return typeof F=="symbol"?F:String(F)}function c(I,F){if(typeof I!="object"||I===null)return I;var P=I[Symbol.toPrimitive];if(P!==void 0){var O=P.call(I,F);if(typeof O!="object")return O;throw new TypeError("@@toPrimitive must return a primitive value.")}return(F==="string"?String:Number)(I)}var f=ft(),l=Symbol("lastResolve"),p=Symbol("lastReject"),i=Symbol("error"),b=Symbol("ended"),S=Symbol("lastPromise"),B=Symbol("handlePromise"),E=Symbol("stream");function C(I,F){return{value:I,done:F}}function T(I){var F=I[l];if(F!==null){var P=I[E].read();P!==null&&(I[S]=null,I[l]=null,I[p]=null,F(C(P,!1)))}}function s(I){process.nextTick(T,I)}function m(I,F){return function(P,O){I.then(function(){if(F[b]){P(C(void 0,!0));return}F[B](P,O)},O)}}var y=Object.getPrototypeOf(function(){}),d=Object.setPrototypeOf((_={get stream(){return this[E]},next:function(){var F=this,P=this[i];if(P!==null)return Promise.reject(P);if(this[b])return Promise.resolve(C(void 0,!0));if(this[E].destroyed)return new Promise(function(U,J){process.nextTick(function(){F[i]?J(F[i]):U(C(void 0,!0))})});var O=this[S],D;if(O)D=new Promise(m(O,this));else{var L=this[E].read();if(L!==null)return Promise.resolve(C(L,!1));D=new Promise(this[B])}return this[S]=D,D}},n(_,Symbol.asyncIterator,function(){return this}),n(_,"return",function(){var F=this;return new Promise(function(P,O){F[E].destroy(null,function(D){if(D){O(D);return}P(C(void 0,!0))})})}),_),y),w=function(F){var P,O=Object.create(d,(P={},n(P,E,{value:F,writable:!0}),n(P,l,{value:null,writable:!0}),n(P,p,{value:null,writable:!0}),n(P,i,{value:null,writable:!0}),n(P,b,{value:F._readableState.endEmitted,writable:!0}),n(P,B,{value:function(L,U){var J=O[E].read();J?(O[S]=null,O[l]=null,O[p]=null,L(C(J,!1))):(O[l]=L,O[p]=U)},writable:!0}),P));return O[S]=null,f(F,function(D){if(D&&D.code!=="ERR_STREAM_PREMATURE_CLOSE"){var L=O[p];L!==null&&(O[S]=null,O[l]=null,O[p]=null,L(D)),O[i]=D;return}var U=O[l];U!==null&&(O[S]=null,O[l]=null,O[p]=null,U(C(void 0,!0))),O[b]=!0}),F.on("readable",s.bind(null,O)),O};return it=w,it}var ot,Mt;function Er(){return Mt||(Mt=1,ot=function(){throw new Error("Readable.from is not available in the browser")}),ot}var st,Lt;function Qt(){if(Lt)return st;Lt=1,st=U;var _;U.ReadableState=L,He.EventEmitter;var n=function(h,N){return h.listeners(N).length},o=Jt(),c=Fe().Buffer,f=(typeof oe<"u"?oe:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){};function l(u){return c.from(u)}function p(u){return c.isBuffer(u)||u instanceof f}var i=He,b;i&&i.debuglog?b=i.debuglog("stream"):b=function(){};var S=wr(),B=Kt(),E=zt(),C=E.getHighWaterMark,T=Se().codes,s=T.ERR_INVALID_ARG_TYPE,m=T.ERR_STREAM_PUSH_AFTER_EOF,y=T.ERR_METHOD_NOT_IMPLEMENTED,d=T.ERR_STREAM_UNSHIFT_AFTER_END_EVENT,w,I,F;ke()(U,o);var P=B.errorOrDestroy,O=["error","close","destroy","pause","resume"];function D(u,h,N){if(typeof u.prependListener=="function")return u.prependListener(h,N);!u._events||!u._events[h]?u.on(h,N):Array.isArray(u._events[h])?u._events[h].unshift(N):u._events[h]=[N,u._events[h]]}function L(u,h,N){_=_||ve(),u=u||{},typeof N!="boolean"&&(N=h instanceof _),this.objectMode=!!u.objectMode,N&&(this.objectMode=this.objectMode||!!u.readableObjectMode),this.highWaterMark=C(this,u,"readableHighWaterMark",N),this.buffer=new S,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=u.emitClose!==!1,this.autoDestroy=!!u.autoDestroy,this.destroyed=!1,this.defaultEncoding=u.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,u.encoding&&(w||(w=kt().StringDecoder),this.decoder=new w(u.encoding),this.encoding=u.encoding)}function U(u){if(_=_||ve(),!(this instanceof U))return new U(u);var h=this instanceof _;this._readableState=new L(u,this,h),this.readable=!0,u&&(typeof u.read=="function"&&(this._read=u.read),typeof u.destroy=="function"&&(this._destroy=u.destroy)),o.call(this)}Object.defineProperty(U.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0?!1:this._readableState.destroyed},set:function(h){this._readableState&&(this._readableState.destroyed=h)}}),U.prototype.destroy=B.destroy,U.prototype._undestroy=B.undestroy,U.prototype._destroy=function(u,h){h(u)},U.prototype.push=function(u,h){var N=this._readableState,M;return N.objectMode?M=!0:typeof u=="string"&&(h=h||N.defaultEncoding,h!==N.encoding&&(u=c.from(u,h),h=""),M=!0),J(this,u,h,!1,M)},U.prototype.unshift=function(u){return J(this,u,null,!0,!1)};function J(u,h,N,M,Y){b("readableAddChunk",h);var W=u._readableState;if(h===null)W.reading=!1,Ae(u,W);else{var j;if(Y||(j=Be(W,h)),j)P(u,j);else if(W.objectMode||h&&h.length>0)if(typeof h!="string"&&!W.objectMode&&Object.getPrototypeOf(h)!==c.prototype&&(h=l(h)),M)W.endEmitted?P(u,new d):se(u,W,h,!0);else if(W.ended)P(u,new m);else{if(W.destroyed)return!1;W.reading=!1,W.decoder&&!N?(h=W.decoder.write(h),W.objectMode||h.length!==0?se(u,W,h,!1):le(u,W)):se(u,W,h,!1)}else M||(W.reading=!1,le(u,W))}return!W.ended&&(W.length<W.highWaterMark||W.length===0)}function se(u,h,N,M){h.flowing&&h.length===0&&!h.sync?(h.awaitDrain=0,u.emit("data",N)):(h.length+=h.objectMode?1:N.length,M?h.buffer.unshift(N):h.buffer.push(N),h.needReadable&&ie(u)),le(u,h)}function Be(u,h){var N;return!p(h)&&typeof h!="string"&&h!==void 0&&!u.objectMode&&(N=new s("chunk",["string","Buffer","Uint8Array"],h)),N}U.prototype.isPaused=function(){return this._readableState.flowing===!1},U.prototype.setEncoding=function(u){w||(w=kt().StringDecoder);var h=new w(u);this._readableState.decoder=h,this._readableState.encoding=this._readableState.decoder.encoding;for(var N=this._readableState.buffer.head,M="";N!==null;)M+=h.write(N.data),N=N.next;return this._readableState.buffer.clear(),M!==""&&this._readableState.buffer.push(M),this._readableState.length=M.length,this};var ae=1073741824;function ye(u){return u>=ae?u=ae:(u--,u|=u>>>1,u|=u>>>2,u|=u>>>4,u|=u>>>8,u|=u>>>16,u++),u}function ce(u,h){return u<=0||h.length===0&&h.ended?0:h.objectMode?1:u!==u?h.flowing&&h.length?h.buffer.head.data.length:h.length:(u>h.highWaterMark&&(h.highWaterMark=ye(u)),u<=h.length?u:h.ended?h.length:(h.needReadable=!0,0))}U.prototype.read=function(u){b("read",u),u=parseInt(u,10);var h=this._readableState,N=u;if(u!==0&&(h.emittedReadable=!1),u===0&&h.needReadable&&((h.highWaterMark!==0?h.length>=h.highWaterMark:h.length>0)||h.ended))return b("read: emitReadable",h.length,h.ended),h.length===0&&h.ended?k(this):ie(this),null;if(u=ce(u,h),u===0&&h.ended)return h.length===0&&k(this),null;var M=h.needReadable;b("need readable",M),(h.length===0||h.length-u<h.highWaterMark)&&(M=!0,b("length less than watermark",M)),h.ended||h.reading?(M=!1,b("reading or ended",M)):M&&(b("do read"),h.reading=!0,h.sync=!0,h.length===0&&(h.needReadable=!0),this._read(h.highWaterMark),h.sync=!1,h.reading||(u=ce(N,h)));var Y;return u>0?Y=R(u,h):Y=null,Y===null?(h.needReadable=h.length<=h.highWaterMark,u=0):(h.length-=u,h.awaitDrain=0),h.length===0&&(h.ended||(h.needReadable=!0),N!==u&&h.ended&&k(this)),Y!==null&&this.emit("data",Y),Y};function Ae(u,h){if(b("onEofChunk"),!h.ended){if(h.decoder){var N=h.decoder.end();N&&N.length&&(h.buffer.push(N),h.length+=h.objectMode?1:N.length)}h.ended=!0,h.sync?ie(u):(h.needReadable=!1,h.emittedReadable||(h.emittedReadable=!0,me(u)))}}function ie(u){var h=u._readableState;b("emitReadable",h.needReadable,h.emittedReadable),h.needReadable=!1,h.emittedReadable||(b("emitReadable",h.flowing),h.emittedReadable=!0,process.nextTick(me,u))}function me(u){var h=u._readableState;b("emitReadable_",h.destroyed,h.length,h.ended),!h.destroyed&&(h.length||h.ended)&&(u.emit("readable"),h.emittedReadable=!1),h.needReadable=!h.flowing&&!h.ended&&h.length<=h.highWaterMark,A(u)}function le(u,h){h.readingMore||(h.readingMore=!0,process.nextTick(we,u,h))}function we(u,h){for(;!h.reading&&!h.ended&&(h.length<h.highWaterMark||h.flowing&&h.length===0);){var N=h.length;if(b("maybeReadMore read 0"),u.read(0),N===h.length)break}h.readingMore=!1}U.prototype._read=function(u){P(this,new y("_read()"))},U.prototype.pipe=function(u,h){var N=this,M=this._readableState;switch(M.pipesCount){case 0:M.pipes=u;break;case 1:M.pipes=[M.pipes,u];break;default:M.pipes.push(u);break}M.pipesCount+=1,b("pipe count=%d opts=%j",M.pipesCount,h);var Y=(!h||h.end!==!1)&&u!==process.stdout&&u!==process.stderr,W=Y?ue:de;M.endEmitted?process.nextTick(W):N.once("end",W),u.on("unpipe",j);function j(r,e){b("onunpipe"),r===N&&e&&e.hasUnpiped===!1&&(e.hasUnpiped=!0,Re())}function ue(){b("onend"),u.end()}var Ee=K(N);u.on("drain",Ee);var Te=!1;function Re(){b("cleanup"),u.removeListener("close",Ie),u.removeListener("finish",te),u.removeListener("drain",Ee),u.removeListener("error",he),u.removeListener("unpipe",j),N.removeListener("end",ue),N.removeListener("end",de),N.removeListener("data",ee),Te=!0,M.awaitDrain&&(!u._writableState||u._writableState.needDrain)&&Ee()}N.on("data",ee);function ee(r){b("ondata");var e=u.write(r);b("dest.write",e),e===!1&&((M.pipesCount===1&&M.pipes===u||M.pipesCount>1&&q(M.pipes,u)!==-1)&&!Te&&(b("false write response, pause",M.awaitDrain),M.awaitDrain++),N.pause())}function he(r){b("onerror",r),de(),u.removeListener("error",he),n(u,"error")===0&&P(u,r)}D(u,"error",he);function Ie(){u.removeListener("finish",te),de()}u.once("close",Ie);function te(){b("onfinish"),u.removeListener("close",Ie),de()}u.once("finish",te);function de(){b("unpipe"),N.unpipe(u)}return u.emit("pipe",N),M.flowing||(b("pipe resume"),N.resume()),u};function K(u){return function(){var N=u._readableState;b("pipeOnDrain",N.awaitDrain),N.awaitDrain&&N.awaitDrain--,N.awaitDrain===0&&n(u,"data")&&(N.flowing=!0,A(u))}}U.prototype.unpipe=function(u){var h=this._readableState,N={hasUnpiped:!1};if(h.pipesCount===0)return this;if(h.pipesCount===1)return u&&u!==h.pipes?this:(u||(u=h.pipes),h.pipes=null,h.pipesCount=0,h.flowing=!1,u&&u.emit("unpipe",this,N),this);if(!u){var M=h.pipes,Y=h.pipesCount;h.pipes=null,h.pipesCount=0,h.flowing=!1;for(var W=0;W<Y;W++)M[W].emit("unpipe",this,{hasUnpiped:!1});return this}var j=q(h.pipes,u);return j===-1?this:(h.pipes.splice(j,1),h.pipesCount-=1,h.pipesCount===1&&(h.pipes=h.pipes[0]),u.emit("unpipe",this,N),this)},U.prototype.on=function(u,h){var N=o.prototype.on.call(this,u,h),M=this._readableState;return u==="data"?(M.readableListening=this.listenerCount("readable")>0,M.flowing!==!1&&this.resume()):u==="readable"&&!M.endEmitted&&!M.readableListening&&(M.readableListening=M.needReadable=!0,M.flowing=!1,M.emittedReadable=!1,b("on readable",M.length,M.reading),M.length?ie(this):M.reading||process.nextTick(re,this)),N},U.prototype.addListener=U.prototype.on,U.prototype.removeListener=function(u,h){var N=o.prototype.removeListener.call(this,u,h);return u==="readable"&&process.nextTick(Q,this),N},U.prototype.removeAllListeners=function(u){var h=o.prototype.removeAllListeners.apply(this,arguments);return(u==="readable"||u===void 0)&&process.nextTick(Q,this),h};function Q(u){var h=u._readableState;h.readableListening=u.listenerCount("readable")>0,h.resumeScheduled&&!h.paused?h.flowing=!0:u.listenerCount("data")>0&&u.resume()}function re(u){b("readable nexttick read 0"),u.read(0)}U.prototype.resume=function(){var u=this._readableState;return u.flowing||(b("resume"),u.flowing=!u.readableListening,_e(this,u)),u.paused=!1,this};function _e(u,h){h.resumeScheduled||(h.resumeScheduled=!0,process.nextTick(be,u,h))}function be(u,h){b("resume",h.reading),h.reading||u.read(0),h.resumeScheduled=!1,u.emit("resume"),A(u),h.flowing&&!h.reading&&u.read(0)}U.prototype.pause=function(){return b("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(b("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this};function A(u){var h=u._readableState;for(b("flow",h.flowing);h.flowing&&u.read()!==null;);}U.prototype.wrap=function(u){var h=this,N=this._readableState,M=!1;u.on("end",function(){if(b("wrapped end"),N.decoder&&!N.ended){var j=N.decoder.end();j&&j.length&&h.push(j)}h.push(null)}),u.on("data",function(j){if(b("wrapped data"),N.decoder&&(j=N.decoder.write(j)),!(N.objectMode&&j==null)&&!(!N.objectMode&&(!j||!j.length))){var ue=h.push(j);ue||(M=!0,u.pause())}});for(var Y in u)this[Y]===void 0&&typeof u[Y]=="function"&&(this[Y]=function(ue){return function(){return u[ue].apply(u,arguments)}}(Y));for(var W=0;W<O.length;W++)u.on(O[W],this.emit.bind(this,O[W]));return this._read=function(j){b("wrapped _read",j),M&&(M=!1,u.resume())},this},typeof Symbol=="function"&&(U.prototype[Symbol.asyncIterator]=function(){return I===void 0&&(I=br()),I(this)}),Object.defineProperty(U.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(U.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(U.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(h){this._readableState&&(this._readableState.flowing=h)}}),U._fromList=R,Object.defineProperty(U.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}});function R(u,h){if(h.length===0)return null;var N;return h.objectMode?N=h.buffer.shift():!u||u>=h.length?(h.decoder?N=h.buffer.join(""):h.buffer.length===1?N=h.buffer.first():N=h.buffer.concat(h.length),h.buffer.clear()):N=h.buffer.consume(u,h.decoder),N}function k(u){var h=u._readableState;b("endReadable",h.endEmitted),h.endEmitted||(h.ended=!0,process.nextTick($,h,u))}function $(u,h){if(b("endReadableNT",u.endEmitted,u.length),!u.endEmitted&&u.length===0&&(u.endEmitted=!0,h.readable=!1,h.emit("end"),u.autoDestroy)){var N=h._writableState;(!N||N.autoDestroy&&N.finished)&&h.destroy()}}typeof Symbol=="function"&&(U.from=function(u,h){return F===void 0&&(F=Er()),F(U,u,h)});function q(u,h){for(var N=0,M=u.length;N<M;N++)if(u[N]===h)return N;return-1}return st}var at,Ut;function Zt(){if(Ut)return at;Ut=1,at=i;var _=Se().codes,n=_.ERR_METHOD_NOT_IMPLEMENTED,o=_.ERR_MULTIPLE_CALLBACK,c=_.ERR_TRANSFORM_ALREADY_TRANSFORMING,f=_.ERR_TRANSFORM_WITH_LENGTH_0,l=ve();ke()(i,l);function p(B,E){var C=this._transformState;C.transforming=!1;var T=C.writecb;if(T===null)return this.emit("error",new o);C.writechunk=null,C.writecb=null,E!=null&&this.push(E),T(B);var s=this._readableState;s.reading=!1,(s.needReadable||s.length<s.highWaterMark)&&this._read(s.highWaterMark)}function i(B){if(!(this instanceof i))return new i(B);l.call(this,B),this._transformState={afterTransform:p.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,B&&(typeof B.transform=="function"&&(this._transform=B.transform),typeof B.flush=="function"&&(this._flush=B.flush)),this.on("prefinish",b)}function b(){var B=this;typeof this._flush=="function"&&!this._readableState.destroyed?this._flush(function(E,C){S(B,E,C)}):S(this,null,null)}i.prototype.push=function(B,E){return this._transformState.needTransform=!1,l.prototype.push.call(this,B,E)},i.prototype._transform=function(B,E,C){C(new n("_transform()"))},i.prototype._write=function(B,E,C){var T=this._transformState;if(T.writecb=C,T.writechunk=B,T.writeencoding=E,!T.transforming){var s=this._readableState;(T.needTransform||s.needReadable||s.length<s.highWaterMark)&&this._read(s.highWaterMark)}},i.prototype._read=function(B){var E=this._transformState;E.writechunk!==null&&!E.transforming?(E.transforming=!0,this._transform(E.writechunk,E.writeencoding,E.afterTransform)):E.needTransform=!0},i.prototype._destroy=function(B,E){l.prototype._destroy.call(this,B,function(C){E(C)})};function S(B,E,C){if(E)return B.emit("error",E);if(C!=null&&B.push(C),B._writableState.length)throw new f;if(B._transformState.transforming)throw new c;return B.push(null)}return at}var lt,$t;function Rr(){if($t)return lt;$t=1,lt=n;var _=Zt();ke()(n,_);function n(o){if(!(this instanceof n))return new n(o);_.call(this,o)}return n.prototype._transform=function(o,c,f){f(null,o)},lt}var ut,qt;function Cr(){if(qt)return ut;qt=1;var _;function n(C){var T=!1;return function(){T||(T=!0,C.apply(void 0,arguments))}}var o=Se().codes,c=o.ERR_MISSING_ARGS,f=o.ERR_STREAM_DESTROYED;function l(C){if(C)throw C}function p(C){return C.setHeader&&typeof C.abort=="function"}function i(C,T,s,m){m=n(m);var y=!1;C.on("close",function(){y=!0}),_===void 0&&(_=ft()),_(C,{readable:T,writable:s},function(w){if(w)return m(w);y=!0,m()});var d=!1;return function(w){if(!y&&!d){if(d=!0,p(C))return C.abort();if(typeof C.destroy=="function")return C.destroy();m(w||new f("pipe"))}}}function b(C){C()}function S(C,T){return C.pipe(T)}function B(C){return!C.length||typeof C[C.length-1]!="function"?l:C.pop()}function E(){for(var C=arguments.length,T=new Array(C),s=0;s<C;s++)T[s]=arguments[s];var m=B(T);if(Array.isArray(T[0])&&(T=T[0]),T.length<2)throw new c("streams");var y,d=T.map(function(w,I){var F=I<T.length-1,P=I>0;return i(w,F,P,function(O){y||(y=O),O&&d.forEach(b),!F&&(d.forEach(b),m(y))})});return T.reduce(S)}return ut=E,ut}var Wt;function vr(){return Wt||(Wt=1,function(_,n){n=_.exports=Qt(),n.Stream=n,n.Readable=n,n.Writable=Xt(),n.Duplex=ve(),n.Transform=Zt(),n.PassThrough=Rr(),n.finished=ft(),n.pipeline=Cr()}($e,$e.exports)),$e.exports}/*! queue-microtask. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */var ct,Ht;function Sr(){if(Ht)return ct;Ht=1;let _;return ct=typeof queueMicrotask=="function"?queueMicrotask.bind(typeof window<"u"?window:oe):n=>(_||(_=Promise.resolve())).then(n).catch(o=>setTimeout(()=>{throw o},0)),ct}var ht,jt;function Br(){if(jt)return ht;jt=1;function _(o,c){for(const f in c)Object.defineProperty(o,f,{value:c[f],enumerable:!0,configurable:!0});return o}function n(o,c,f){if(!o||typeof o=="string")throw new TypeError("Please pass an Error to err-code");f||(f={}),typeof c=="object"&&(f=c,c=""),c&&(f.code=c);try{return _(o,f)}catch{f.message=o.message,f.stack=o.stack;const p=function(){};return p.prototype=Object.create(Object.getPrototypeOf(o)),_(new p,f)}}return ht=n,ht}/*! simple-peer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */var dt,Gt;function Ar(){if(Gt)return dt;Gt=1;const _=hr()("simple-peer"),n=dr(),o=gr(),c=vr(),f=Sr(),l=Br(),{Buffer:p}=Fe(),i=64*1024,b=5*1e3,S=5*1e3;function B(T){return T.replace(/a=ice-options:trickle\s\n/g,"")}function E(T){console.warn(T)}class C extends c.Duplex{constructor(s){if(s=Object.assign({allowHalfOpen:!1},s),super(s),this._id=o(4).toString("hex").slice(0,7),this._debug("new peer %o",s),this.channelName=s.initiator?s.channelName||o(20).toString("hex"):null,this.initiator=s.initiator||!1,this.channelConfig=s.channelConfig||C.channelConfig,this.channelNegotiated=this.channelConfig.negotiated,this.config=Object.assign({},C.config,s.config),this.offerOptions=s.offerOptions||{},this.answerOptions=s.answerOptions||{},this.sdpTransform=s.sdpTransform||(m=>m),this.streams=s.streams||(s.stream?[s.stream]:[]),this.trickle=s.trickle!==void 0?s.trickle:!0,this.allowHalfTrickle=s.allowHalfTrickle!==void 0?s.allowHalfTrickle:!1,this.iceCompleteTimeout=s.iceCompleteTimeout||b,this.destroyed=!1,this.destroying=!1,this._connected=!1,this.remoteAddress=void 0,this.remoteFamily=void 0,this.remotePort=void 0,this.localAddress=void 0,this.localFamily=void 0,this.localPort=void 0,this._wrtc=s.wrtc&&typeof s.wrtc=="object"?s.wrtc:n(),!this._wrtc)throw l(typeof window>"u"?new Error("No WebRTC support: Specify `opts.wrtc` option in this environment"):new Error("No WebRTC support: Not a supported browser"),"ERR_WEBRTC_SUPPORT");this._pcReady=!1,this._channelReady=!1,this._iceComplete=!1,this._iceCompleteTimer=null,this._channel=null,this._pendingCandidates=[],this._isNegotiating=!1,this._firstNegotiation=!0,this._batchedNegotiation=!1,this._queuedNegotiation=!1,this._sendersAwaitingStable=[],this._senderMap=new Map,this._closingInterval=null,this._remoteTracks=[],this._remoteStreams=[],this._chunk=null,this._cb=null,this._interval=null;try{this._pc=new this._wrtc.RTCPeerConnection(this.config)}catch(m){this.destroy(l(m,"ERR_PC_CONSTRUCTOR"));return}this._isReactNativeWebrtc=typeof this._pc._peerConnectionId=="number",this._pc.oniceconnectionstatechange=()=>{this._onIceStateChange()},this._pc.onicegatheringstatechange=()=>{this._onIceStateChange()},this._pc.onconnectionstatechange=()=>{this._onConnectionStateChange()},this._pc.onsignalingstatechange=()=>{this._onSignalingStateChange()},this._pc.onicecandidate=m=>{this._onIceCandidate(m)},typeof this._pc.peerIdentity=="object"&&this._pc.peerIdentity.catch(m=>{this.destroy(l(m,"ERR_PC_PEER_IDENTITY"))}),this.initiator||this.channelNegotiated?this._setupData({channel:this._pc.createDataChannel(this.channelName,this.channelConfig)}):this._pc.ondatachannel=m=>{this._setupData(m)},this.streams&&this.streams.forEach(m=>{this.addStream(m)}),this._pc.ontrack=m=>{this._onTrack(m)},this._debug("initial negotiation"),this._needsNegotiation(),this._onFinishBound=()=>{this._onFinish()},this.once("finish",this._onFinishBound)}get bufferSize(){return this._channel&&this._channel.bufferedAmount||0}get connected(){return this._connected&&this._channel.readyState==="open"}address(){return{port:this.localPort,family:this.localFamily,address:this.localAddress}}signal(s){if(!this.destroying){if(this.destroyed)throw l(new Error("cannot signal after peer is destroyed"),"ERR_DESTROYED");if(typeof s=="string")try{s=JSON.parse(s)}catch{s={}}this._debug("signal()"),s.renegotiate&&this.initiator&&(this._debug("got request to renegotiate"),this._needsNegotiation()),s.transceiverRequest&&this.initiator&&(this._debug("got request for transceiver"),this.addTransceiver(s.transceiverRequest.kind,s.transceiverRequest.init)),s.candidate&&(this._pc.remoteDescription&&this._pc.remoteDescription.type?this._addIceCandidate(s.candidate):this._pendingCandidates.push(s.candidate)),s.sdp&&this._pc.setRemoteDescription(new this._wrtc.RTCSessionDescription(s)).then(()=>{this.destroyed||(this._pendingCandidates.forEach(m=>{this._addIceCandidate(m)}),this._pendingCandidates=[],this._pc.remoteDescription.type==="offer"&&this._createAnswer())}).catch(m=>{this.destroy(l(m,"ERR_SET_REMOTE_DESCRIPTION"))}),!s.sdp&&!s.candidate&&!s.renegotiate&&!s.transceiverRequest&&this.destroy(l(new Error("signal() called with invalid signal data"),"ERR_SIGNALING"))}}_addIceCandidate(s){const m=new this._wrtc.RTCIceCandidate(s);this._pc.addIceCandidate(m).catch(y=>{!m.address||m.address.endsWith(".local")?E("Ignoring unsupported ICE candidate."):this.destroy(l(y,"ERR_ADD_ICE_CANDIDATE"))})}send(s){if(!this.destroying){if(this.destroyed)throw l(new Error("cannot send after peer is destroyed"),"ERR_DESTROYED");this._channel.send(s)}}addTransceiver(s,m){if(!this.destroying){if(this.destroyed)throw l(new Error("cannot addTransceiver after peer is destroyed"),"ERR_DESTROYED");if(this._debug("addTransceiver()"),this.initiator)try{this._pc.addTransceiver(s,m),this._needsNegotiation()}catch(y){this.destroy(l(y,"ERR_ADD_TRANSCEIVER"))}else this.emit("signal",{type:"transceiverRequest",transceiverRequest:{kind:s,init:m}})}}addStream(s){if(!this.destroying){if(this.destroyed)throw l(new Error("cannot addStream after peer is destroyed"),"ERR_DESTROYED");this._debug("addStream()"),s.getTracks().forEach(m=>{this.addTrack(m,s)})}}addTrack(s,m){if(this.destroying)return;if(this.destroyed)throw l(new Error("cannot addTrack after peer is destroyed"),"ERR_DESTROYED");this._debug("addTrack()");const y=this._senderMap.get(s)||new Map;let d=y.get(m);if(!d)d=this._pc.addTrack(s,m),y.set(m,d),this._senderMap.set(s,y),this._needsNegotiation();else throw d.removed?l(new Error("Track has been removed. You should enable/disable tracks that you want to re-add."),"ERR_SENDER_REMOVED"):l(new Error("Track has already been added to that stream."),"ERR_SENDER_ALREADY_ADDED")}replaceTrack(s,m,y){if(this.destroying)return;if(this.destroyed)throw l(new Error("cannot replaceTrack after peer is destroyed"),"ERR_DESTROYED");this._debug("replaceTrack()");const d=this._senderMap.get(s),w=d?d.get(y):null;if(!w)throw l(new Error("Cannot replace track that was never added."),"ERR_TRACK_NOT_ADDED");m&&this._senderMap.set(m,d),w.replaceTrack!=null?w.replaceTrack(m):this.destroy(l(new Error("replaceTrack is not supported in this browser"),"ERR_UNSUPPORTED_REPLACETRACK"))}removeTrack(s,m){if(this.destroying)return;if(this.destroyed)throw l(new Error("cannot removeTrack after peer is destroyed"),"ERR_DESTROYED");this._debug("removeSender()");const y=this._senderMap.get(s),d=y?y.get(m):null;if(!d)throw l(new Error("Cannot remove track that was never added."),"ERR_TRACK_NOT_ADDED");try{d.removed=!0,this._pc.removeTrack(d)}catch(w){w.name==="NS_ERROR_UNEXPECTED"?this._sendersAwaitingStable.push(d):this.destroy(l(w,"ERR_REMOVE_TRACK"))}this._needsNegotiation()}removeStream(s){if(!this.destroying){if(this.destroyed)throw l(new Error("cannot removeStream after peer is destroyed"),"ERR_DESTROYED");this._debug("removeSenders()"),s.getTracks().forEach(m=>{this.removeTrack(m,s)})}}_needsNegotiation(){this._debug("_needsNegotiation"),!this._batchedNegotiation&&(this._batchedNegotiation=!0,f(()=>{this._batchedNegotiation=!1,this.initiator||!this._firstNegotiation?(this._debug("starting batched negotiation"),this.negotiate()):this._debug("non-initiator initial negotiation request discarded"),this._firstNegotiation=!1}))}negotiate(){if(!this.destroying){if(this.destroyed)throw l(new Error("cannot negotiate after peer is destroyed"),"ERR_DESTROYED");this.initiator?this._isNegotiating?(this._queuedNegotiation=!0,this._debug("already negotiating, queueing")):(this._debug("start negotiation"),setTimeout(()=>{this._createOffer()},0)):this._isNegotiating?(this._queuedNegotiation=!0,this._debug("already negotiating, queueing")):(this._debug("requesting negotiation from initiator"),this.emit("signal",{type:"renegotiate",renegotiate:!0})),this._isNegotiating=!0}}destroy(s){this._destroy(s,()=>{})}_destroy(s,m){this.destroyed||this.destroying||(this.destroying=!0,this._debug("destroying (error: %s)",s&&(s.message||s)),f(()=>{if(this.destroyed=!0,this.destroying=!1,this._debug("destroy (error: %s)",s&&(s.message||s)),this.readable=this.writable=!1,this._readableState.ended||this.push(null),this._writableState.finished||this.end(),this._connected=!1,this._pcReady=!1,this._channelReady=!1,this._remoteTracks=null,this._remoteStreams=null,this._senderMap=null,clearInterval(this._closingInterval),this._closingInterval=null,clearInterval(this._interval),this._interval=null,this._chunk=null,this._cb=null,this._onFinishBound&&this.removeListener("finish",this._onFinishBound),this._onFinishBound=null,this._channel){try{this._channel.close()}catch{}this._channel.onmessage=null,this._channel.onopen=null,this._channel.onclose=null,this._channel.onerror=null}if(this._pc){try{this._pc.close()}catch{}this._pc.oniceconnectionstatechange=null,this._pc.onicegatheringstatechange=null,this._pc.onsignalingstatechange=null,this._pc.onicecandidate=null,this._pc.ontrack=null,this._pc.ondatachannel=null}this._pc=null,this._channel=null,s&&this.emit("error",s),this.emit("close"),m()}))}_setupData(s){if(!s.channel)return this.destroy(l(new Error("Data channel event is missing `channel` property"),"ERR_DATA_CHANNEL"));this._channel=s.channel,this._channel.binaryType="arraybuffer",typeof this._channel.bufferedAmountLowThreshold=="number"&&(this._channel.bufferedAmountLowThreshold=i),this.channelName=this._channel.label,this._channel.onmessage=y=>{this._onChannelMessage(y)},this._channel.onbufferedamountlow=()=>{this._onChannelBufferedAmountLow()},this._channel.onopen=()=>{this._onChannelOpen()},this._channel.onclose=()=>{this._onChannelClose()},this._channel.onerror=y=>{const d=y.error instanceof Error?y.error:new Error(`Datachannel error: ${y.message} ${y.filename}:${y.lineno}:${y.colno}`);this.destroy(l(d,"ERR_DATA_CHANNEL"))};let m=!1;this._closingInterval=setInterval(()=>{this._channel&&this._channel.readyState==="closing"?(m&&this._onChannelClose(),m=!0):m=!1},S)}_read(){}_write(s,m,y){if(this.destroyed)return y(l(new Error("cannot write after peer is destroyed"),"ERR_DATA_CHANNEL"));if(this._connected){try{this.send(s)}catch(d){return this.destroy(l(d,"ERR_DATA_CHANNEL"))}this._channel.bufferedAmount>i?(this._debug("start backpressure: bufferedAmount %d",this._channel.bufferedAmount),this._cb=y):y(null)}else this._debug("write before connect"),this._chunk=s,this._cb=y}_onFinish(){if(this.destroyed)return;const s=()=>{setTimeout(()=>this.destroy(),1e3)};this._connected?s():this.once("connect",s)}_startIceCompleteTimeout(){this.destroyed||this._iceCompleteTimer||(this._debug("started iceComplete timeout"),this._iceCompleteTimer=setTimeout(()=>{this._iceComplete||(this._iceComplete=!0,this._debug("iceComplete timeout completed"),this.emit("iceTimeout"),this.emit("_iceComplete"))},this.iceCompleteTimeout))}_createOffer(){this.destroyed||this._pc.createOffer(this.offerOptions).then(s=>{if(this.destroyed)return;!this.trickle&&!this.allowHalfTrickle&&(s.sdp=B(s.sdp)),s.sdp=this.sdpTransform(s.sdp);const m=()=>{if(this.destroyed)return;const w=this._pc.localDescription||s;this._debug("signal"),this.emit("signal",{type:w.type,sdp:w.sdp})},y=()=>{this._debug("createOffer success"),!this.destroyed&&(this.trickle||this._iceComplete?m():this.once("_iceComplete",m))},d=w=>{this.destroy(l(w,"ERR_SET_LOCAL_DESCRIPTION"))};this._pc.setLocalDescription(s).then(y).catch(d)}).catch(s=>{this.destroy(l(s,"ERR_CREATE_OFFER"))})}_requestMissingTransceivers(){this._pc.getTransceivers&&this._pc.getTransceivers().forEach(s=>{!s.mid&&s.sender.track&&!s.requested&&(s.requested=!0,this.addTransceiver(s.sender.track.kind))})}_createAnswer(){this.destroyed||this._pc.createAnswer(this.answerOptions).then(s=>{if(this.destroyed)return;!this.trickle&&!this.allowHalfTrickle&&(s.sdp=B(s.sdp)),s.sdp=this.sdpTransform(s.sdp);const m=()=>{if(this.destroyed)return;const w=this._pc.localDescription||s;this._debug("signal"),this.emit("signal",{type:w.type,sdp:w.sdp}),this.initiator||this._requestMissingTransceivers()},y=()=>{this.destroyed||(this.trickle||this._iceComplete?m():this.once("_iceComplete",m))},d=w=>{this.destroy(l(w,"ERR_SET_LOCAL_DESCRIPTION"))};this._pc.setLocalDescription(s).then(y).catch(d)}).catch(s=>{this.destroy(l(s,"ERR_CREATE_ANSWER"))})}_onConnectionStateChange(){this.destroyed||this._pc.connectionState==="failed"&&this.destroy(l(new Error("Connection failed."),"ERR_CONNECTION_FAILURE"))}_onIceStateChange(){if(this.destroyed)return;const s=this._pc.iceConnectionState,m=this._pc.iceGatheringState;this._debug("iceStateChange (connection: %s) (gathering: %s)",s,m),this.emit("iceStateChange",s,m),(s==="connected"||s==="completed")&&(this._pcReady=!0,this._maybeReady()),s==="failed"&&this.destroy(l(new Error("Ice connection failed."),"ERR_ICE_CONNECTION_FAILURE")),s==="closed"&&this.destroy(l(new Error("Ice connection closed."),"ERR_ICE_CONNECTION_CLOSED"))}getStats(s){const m=y=>(Object.prototype.toString.call(y.values)==="[object Array]"&&y.values.forEach(d=>{Object.assign(y,d)}),y);this._pc.getStats.length===0||this._isReactNativeWebrtc?this._pc.getStats().then(y=>{const d=[];y.forEach(w=>{d.push(m(w))}),s(null,d)},y=>s(y)):this._pc.getStats.length>0?this._pc.getStats(y=>{if(this.destroyed)return;const d=[];y.result().forEach(w=>{const I={};w.names().forEach(F=>{I[F]=w.stat(F)}),I.id=w.id,I.type=w.type,I.timestamp=w.timestamp,d.push(m(I))}),s(null,d)},y=>s(y)):s(null,[])}_maybeReady(){if(this._debug("maybeReady pc %s channel %s",this._pcReady,this._channelReady),this._connected||this._connecting||!this._pcReady||!this._channelReady)return;this._connecting=!0;const s=()=>{this.destroyed||this.getStats((m,y)=>{if(this.destroyed)return;m&&(y=[]);const d={},w={},I={};let F=!1;y.forEach(O=>{(O.type==="remotecandidate"||O.type==="remote-candidate")&&(d[O.id]=O),(O.type==="localcandidate"||O.type==="local-candidate")&&(w[O.id]=O),(O.type==="candidatepair"||O.type==="candidate-pair")&&(I[O.id]=O)});const P=O=>{F=!0;let D=w[O.localCandidateId];D&&(D.ip||D.address)?(this.localAddress=D.ip||D.address,this.localPort=Number(D.port)):D&&D.ipAddress?(this.localAddress=D.ipAddress,this.localPort=Number(D.portNumber)):typeof O.googLocalAddress=="string"&&(D=O.googLocalAddress.split(":"),this.localAddress=D[0],this.localPort=Number(D[1])),this.localAddress&&(this.localFamily=this.localAddress.includes(":")?"IPv6":"IPv4");let L=d[O.remoteCandidateId];L&&(L.ip||L.address)?(this.remoteAddress=L.ip||L.address,this.remotePort=Number(L.port)):L&&L.ipAddress?(this.remoteAddress=L.ipAddress,this.remotePort=Number(L.portNumber)):typeof O.googRemoteAddress=="string"&&(L=O.googRemoteAddress.split(":"),this.remoteAddress=L[0],this.remotePort=Number(L[1])),this.remoteAddress&&(this.remoteFamily=this.remoteAddress.includes(":")?"IPv6":"IPv4"),this._debug("connect local: %s:%s remote: %s:%s",this.localAddress,this.localPort,this.remoteAddress,this.remotePort)};if(y.forEach(O=>{O.type==="transport"&&O.selectedCandidatePairId&&P(I[O.selectedCandidatePairId]),(O.type==="googCandidatePair"&&O.googActiveConnection==="true"||(O.type==="candidatepair"||O.type==="candidate-pair")&&O.selected)&&P(O)}),!F&&(!Object.keys(I).length||Object.keys(w).length)){setTimeout(s,100);return}else this._connecting=!1,this._connected=!0;if(this._chunk){try{this.send(this._chunk)}catch(D){return this.destroy(l(D,"ERR_DATA_CHANNEL"))}this._chunk=null,this._debug('sent chunk from "write before connect"');const O=this._cb;this._cb=null,O(null)}typeof this._channel.bufferedAmountLowThreshold!="number"&&(this._interval=setInterval(()=>this._onInterval(),150),this._interval.unref&&this._interval.unref()),this._debug("connect"),this.emit("connect")})};s()}_onInterval(){!this._cb||!this._channel||this._channel.bufferedAmount>i||this._onChannelBufferedAmountLow()}_onSignalingStateChange(){this.destroyed||(this._pc.signalingState==="stable"&&(this._isNegotiating=!1,this._debug("flushing sender queue",this._sendersAwaitingStable),this._sendersAwaitingStable.forEach(s=>{this._pc.removeTrack(s),this._queuedNegotiation=!0}),this._sendersAwaitingStable=[],this._queuedNegotiation?(this._debug("flushing negotiation queue"),this._queuedNegotiation=!1,this._needsNegotiation()):(this._debug("negotiated"),this.emit("negotiated"))),this._debug("signalingStateChange %s",this._pc.signalingState),this.emit("signalingStateChange",this._pc.signalingState))}_onIceCandidate(s){this.destroyed||(s.candidate&&this.trickle?this.emit("signal",{type:"candidate",candidate:{candidate:s.candidate.candidate,sdpMLineIndex:s.candidate.sdpMLineIndex,sdpMid:s.candidate.sdpMid}}):!s.candidate&&!this._iceComplete&&(this._iceComplete=!0,this.emit("_iceComplete")),s.candidate&&this._startIceCompleteTimeout())}_onChannelMessage(s){if(this.destroyed)return;let m=s.data;m instanceof ArrayBuffer&&(m=p.from(m)),this.push(m)}_onChannelBufferedAmountLow(){if(this.destroyed||!this._cb)return;this._debug("ending backpressure: bufferedAmount %d",this._channel.bufferedAmount);const s=this._cb;this._cb=null,s(null)}_onChannelOpen(){this._connected||this.destroyed||(this._debug("on channel open"),this._channelReady=!0,this._maybeReady())}_onChannelClose(){this.destroyed||(this._debug("on channel close"),this.destroy())}_onTrack(s){this.destroyed||s.streams.forEach(m=>{this._debug("on track"),this.emit("track",s.track,m),this._remoteTracks.push({track:s.track,stream:m}),!this._remoteStreams.some(y=>y.id===m.id)&&(this._remoteStreams.push(m),f(()=>{this._debug("on stream"),this.emit("stream",m)}))})}_debug(){const s=[].slice.call(arguments);s[0]="["+this._id+"] "+s[0],_.apply(null,s)}}return C.WEBRTC_SUPPORT=!!n(),C.config={iceServers:[{urls:["stun:stun.l.google.com:19302","stun:global.stun.twilio.com:3478"]}],sdpSemantics:"unified-plan"},C.channelConfig={},dt=C,dt}var Tr=Ar();const Yt=ar(Tr);class Ir{constructor(n,o,c,f,l){this.onDataReceivedCallback=n,this.onSignalCallback=o,this.onConnectCallback=c,this.onCloseCallback=f,this.onErrorCallback=l,console.log("Network class instantiated.")}setupPeerHandlers(n){n.on("signal",o=>{console.log("SIGNAL data generated by peer:",o),this.onSignalCallback(o)}),n.on("connect",()=>{console.log("PEER CONNECTED"),this.onConnectCallback&&this.onConnectCallback()}),n.on("data",o=>{console.log("DATA received from peer:",o.toString());try{const c=JSON.parse(o.toString());this.onDataReceivedCallback(c)}catch(c){console.error("Error parsing received data:",c),this.onErrorCallback&&this.onErrorCallback(new Error("Error parsing received data"))}}),n.on("error",o=>{console.error("PEER ERROR:",o),this.onErrorCallback&&this.onErrorCallback(o instanceof Error?o:new Error(String(o)))}),n.on("close",()=>{console.log("PEER CONNECTION CLOSED"),this.onCloseCallback&&this.onCloseCallback(),this.peer=void 0})}initiateConnection(){this.peer&&(console.warn("Peer already exists. Destroying old one."),this.peer.destroy()),console.log("Initiating peer connection..."),this.peer=new Yt({initiator:!0,trickle:!1}),this.setupPeerHandlers(this.peer)}connectToPeerSignal(n){if(this.peer&&this.peer.initiator){console.log("Initiator received answer signal. Applying signal...");try{const o=typeof n=="string"?JSON.parse(n):n;this.peer.signal(o)}catch(o){console.error("Error parsing or applying signal data:",o),this.onErrorCallback&&this.onErrorCallback(o instanceof Error?o:new Error("Failed to parse signal data"))}return}this.peer&&(console.warn("Peer already exists (as joiner). Destroying old one."),this.peer.destroy()),console.log("Joining peer with received offer signal..."),this.peer=new Yt({initiator:!1,trickle:!1}),this.setupPeerHandlers(this.peer);try{const o=typeof n=="string"?JSON.parse(n):n;this.peer.signal(o)}catch(o){console.error("Error parsing or applying signal data:",o),this.onErrorCallback&&this.onErrorCallback(o instanceof Error?o:new Error("Failed to parse signal data"))}}get isConnected(){return this.peer?this.peer.connected:!1}send(n){if(this.peer&&this.peer.connected)try{const o=JSON.stringify(n);return this.peer.send(o),console.log("Sent message:",n),!0}catch(o){return console.error("Error sending message:",o),this.onErrorCallback&&this.onErrorCallback(new Error("Error stringifying or sending message")),!1}else return console.warn("Cannot send message, peer not connected."),!1}disconnect(){this.peer&&(console.log("Disconnecting peer..."),this.peer.destroy(),this.peer=void 0)}}class xr{constructor(){if(this.foldButton=document.getElementById("foldButton"),this.checkButton=document.getElementById("checkButton"),this.callButton=document.getElementById("callButton"),this.betButton=document.getElementById("betButton"),this.raiseButton=document.getElementById("raiseButton"),this.betAmountInput=document.getElementById("betAmountInput"),this.playerTurnIndicator=document.getElementById("playerTurnIndicator"),this.networkControlsDiv=document.getElementById("network-controls"),this.actionControlsDiv=document.getElementById("action-controls"),!this.foldButton||!this.checkButton||!this.callButton||!this.betButton||!this.raiseButton||!this.betAmountInput||!this.playerTurnIndicator||!this.networkControlsDiv||!this.actionControlsDiv)throw new Error("One or more UI elements for game actions not found in the DOM.");this.hideActionControls()}toggleNetworkControls(n){this.networkControlsDiv&&(this.networkControlsDiv.style.display=n?"block":"none")}showActionControls(){this.actionControlsDiv.classList.remove("hidden"),this.actionControlsDiv.style.display="flex"}hideActionControls(){this.actionControlsDiv.style.display="none"}updateActionButtons(n,o){if(!o||n.bettingRound===ge.GameOver||n.bettingRound===ge.Showdown){this.disableAllActions("Game over or not playing."),this.hideActionControls();return}this.showActionControls();const c=n.activePlayers[n.currentPlayerIndex];if(!(c&&c.id===o&&!c.folded&&!c.isAllIn)){this.disableAllActions(c?`${c.name}'s turn`:"Waiting for player...");return}this.playerTurnIndicator.textContent="Your Turn",this.foldButton.disabled=!1,this.checkButton.disabled=!1,this.callButton.disabled=!1,this.betButton.disabled=!1,this.raiseButton.disabled=!1,this.betAmountInput.disabled=!1;const l=c.currentBet,p=n.currentRoundBet;this.foldButton.disabled=!1,p>0&&l<p?this.checkButton.disabled=!0:this.checkButton.disabled=!1,p>0&&l<p?(this.callButton.disabled=!1,this.callButton.textContent=`Call ${p-l}`):(this.callButton.disabled=!0,this.callButton.textContent="Call"),p===0?(this.betButton.disabled=!1,this.raiseButton.disabled=!0,this.callButton.disabled=!0):(this.betButton.disabled=!0,this.raiseButton.disabled=!1),c.chips===0&&(this.disableAllActions("You are All-In."),this.foldButton.disabled=!0),this.betAmountInput.min=n.minRaise.toString(),this.betAmountInput.placeholder=`Min ${n.minRaise}`}disableAllActions(n){this.foldButton.disabled=!0,this.checkButton.disabled=!0,this.callButton.disabled=!0,this.betButton.disabled=!0,this.raiseButton.disabled=!0,this.betAmountInput.disabled=!0,this.playerTurnIndicator.textContent=n}getBetAmount(){const n=parseInt(this.betAmountInput.value,10);return isNaN(n)||n<=0?(alert("Please enter a valid bet amount."),0):n}clearBetAmount(){this.betAmountInput.value=""}}console.log("Poker Game - UI Interaction Test");document.addEventListener("DOMContentLoaded",()=>{let _,n,o,c,f=null,l=!1;const p=document.getElementById("initiateGame"),i=document.getElementById("outgoingSignal"),b=document.getElementById("incomingSignal"),S=document.getElementById("connectToSignal"),B=document.getElementById("connectionStatus"),E=document.getElementById("foldButton"),C=document.getElementById("checkButton"),T=document.getElementById("callButton"),s=document.getElementById("betButton"),m=document.getElementById("raiseButton");document.getElementById("betAmountInput");try{_=new sr("game-container"),c=new xr}catch(D){console.error("Failed to initialize Graphics or UI:",D),alert(`Error initializing: ${D.message}. Check console.`);return}function y(D){i.value=JSON.stringify(D),B.textContent="Signal generated. Share with peer."}function d(){if(f=l?"p0":"p1",B.textContent=`Connected! You are ${f} ${l?"(Initiator)":"(Joined)"}`,console.log(`Network connected. Local player ID: ${f}`),c.toggleNetworkControls(!1),c.showActionControls(),l){const D=["Player 0","Player 1"];o=new Pe(D,1e3,5,10),o.setupNewHand(),o.dealHands(),n.send({type:"gameStateFull",payload:o.toJSON()}),O()}}function w(D){if(console.log("Data received:",D),!o&&D.type!=="gameStateFull"){console.warn("GameState not initialized, ignoring message type:",D.type);return}switch(D.type){case"gameStateFull":f||(console.error("Received gameStateFull but localPlayerId is not set."),f=l?"p0":"p1"),o=Pe.fromJSON(D.payload,f),console.log("Full GameState updated from peer.");break;case"gameStateUpdate":o&&f&&(o.updateFromJSON(D.payload,f),console.log("GameState partially updated from peer."));break;case"playerAction":if(o&&f){const{playerId:L,action:U,amount:J}=D.payload;L!==f?(console.log(`Applying action from peer: ${L} ${U} ${J||""}`),o.handlePlayerAction(L,U,J)):console.log("Received own action echo, ignoring.")}break;default:console.warn("Unknown message type received:",D.type)}O()}function I(){B.textContent="Disconnected.",f=null,l=!1,c.toggleNetworkControls(!0),c.hideActionControls(),o=void 0,O(),n&&n.disconnect()}function F(D){console.error("Network Error:",D),B.textContent=`Error: ${D.message}`}n=new Ir(w,y,d,I,F),p.addEventListener("click",()=>{l=!0,i.value="",b.value="",n.initiateConnection(),B.textContent="Initiating..."}),S.addEventListener("click",()=>{const D=b.value;if(!D){alert("Please paste the peer's signal first.");return}try{const L=JSON.parse(D);n.peer&&n.peer.initiator||(l=!1),n.connectToPeerSignal(L),B.textContent="Signal pasted. Connecting..."}catch(L){console.error("Invalid signal format:",L),alert("Invalid signal format."),B.textContent="Error: Invalid signal format."}});function P(D,L){if(!o||!f){console.error("Cannot perform action: game state or local player ID not set.");return}const U=o.activePlayers[o.currentPlayerIndex];if(!U||U.id!==f){alert("Not your turn!"),console.warn(`Action attempt by ${f} but current player is ${U==null?void 0:U.id}`);return}let J;if(D==="bet"||D==="raise"){if(!L){console.error("Amount function not provided for bet/raise");return}if(J=L(),J===0&&D==="bet"||J===0&&D==="raise")return;if(D==="raise"&&J<=0){alert("Raise amount must be greater than 0.");return}}o.handlePlayerAction(f,D,J)?(n.send({type:"playerAction",payload:{playerId:f,action:D,amount:J}}),O(),c.clearBetAmount()):alert("Invalid action or amount. Check console.")}E.addEventListener("click",()=>P("fold")),C.addEventListener("click",()=>P("check")),T.addEventListener("click",()=>P("call")),s.addEventListener("click",()=>P("bet",()=>c.getBetAmount())),m.addEventListener("click",()=>P("raise",()=>c.getBetAmount()));function O(){_&&o&&f?(_.drawTable(o.players,o.communityCards,o.pot),c.updateActionButtons(o,f)):_&&(_.drawTable([],[],0),c&&f?c.updateActionButtons(new Pe([],0),f):c&&c.hideActionControls())}c.toggleNetworkControls(!0),c.hideActionControls(),O()});
//# sourceMappingURL=index-CR9YckT7.js.map
